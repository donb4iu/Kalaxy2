load_search_index({"pages":[{"title":"Kalaxy2 Cluster","text":"Useful links: https:\/\/github.com\/donb4iu\/kalaxy2 https:\/\/donb4iu.github.io\/kalaxy2\/","tags":"","url":"index.html"},{"title":"ansible automation","text":"Table of Contents Anisble Automation Ansible Role: microk8s Requirements License Usage Role Variables Basic playbook Custom certificate request template Adding worker only nodes (1.23+ only) Testing Using Molecule wrapper and system Python Using Python virtual environment Create partitions MicroK8s Community play books Storage role #Anisble Automation Kubernetes With Ansible #Ansible Role: microk8s istvano\/ansible_role_microk8s cloud-native-skunkworks\/microk8s-ansible Role to download and install microk8s the smallest, simplest, pure production K8s. #Requirements Ansible &gt;= 2.7 Linux Distribution Debian Family Ubuntu Xenial (16.04) Bionic (18.04) Focal (20.04) Arch Linux (untested) #License MIT #Usage #Role Variables Some variables available in this role are listed here. The full set is defined in [defaults\/main.yml](defaults\/main.yml). microk8s_version: Version to use, defaults to 1.19\/stable. microk8s_plugins: Enable\/disable various plugins. A string will be passed as arg when enabling addon using name:arg microk8s_enable_HA: Enable\/disable high-availability. microk8s_group_HA: Hostgroup whose members will form HA cluster. microk8s_group_WORKERS: Hostgroup whose members will act as worker nodes only (no control-plane components run here) microk8s_csr_template: If defined, will cause a custom CSR to be used in generating certificates. #Basic playbook - hosts: servers roles: - role: istvano.microk8s vars: microk8s_plugins: dns: \"1.1.1.1\" istio: true ingress: true #Custom certificate request template It might be useful to customize the certificate request template used by MicroK8s in generating cluster certificates. For example, additional SANs can be added to the certificates such that the MicroK8s certificates validate when addressed from outside the cluster, such as through a reverse proxy. To generate a CSR template, the easiest is probably to use the role without a template, and then copy the CSR in \/var\/snap\/microk8s\/current\/certs\/csr.conf.template to your playbook\u2019s templates directory, make the edits and set the microk8s_csr_template variable accordingly, and re-run the playbook. #Adding worker only nodes (1.23+ only) It is possible to configure additional nodes to act as workers only within your microk8s cluster. This is possible by configuring the ansible hostgroup microk8s_WORKERS (name of the group is configurable via microk8s_group_WORKERS). Every host listed within the hostgroup will essentially run microk8s join .... --worker, more info on this can be found here: microk8s-clustering. #Testing #Using Molecule wrapper and system Python .\/moleculew lint .\/moleculew create .\/moleculew list .\/moleculew check .\/moleculew test #Using Python virtual environment Set up virtual environment $ python3 -m venv venv Activate the environment $ . venv\/bin\/activate Install Molecule with lint and Docker options $ pip install 'molecule[lint,docker]' Install up-to-date Ansible package if necessary $ pip install ansible Run the test commands: molecule lint molecule create molecule list molecule check molecule test #Create partitions ansible disk partition management using playbook #MicroK8s Ansible Role: microk8s #Community play books Community play books #Storage role Simple Partitioning with Ansible Storage Role","tags":"","url":"ansible\/ansible_automation.html"},{"title":"microk8s setup","text":"Table of Contents MicroK8s Setup Reference Commands #( 01\/06\/24@11:19PM )( donbuddenbaum@donbs-imac ):~\/Documents\/Kalaxy2\/ansible@main\u2717\u2717\u2717 #MicroK8s Setup #Reference An Ansible MicroK8s Install of Kubernetes istvano\/ansible_role_microk8s https:\/\/github.com\/8grams\/ansible-microk8s\/blob\/main\/install_microk8s.yaml https:\/\/github.com\/cloud-native-skunkworks\/microk8s-ansible\/blob\/main\/microk8s\/tasks\/main.yml #Commands ##( 01\/06\/24@11:19PM )( donbuddenbaum@donbs-imac ):~\/Documents\/Kalaxy2\/ansible@main\u2717\u2717\u2717 ansible rpi4 -m ping [WARNING]: Invalid characters were found in group names but not replaced, use -vvvv to see details arm64-02 | SUCCESS =&gt; { &quot;changed&quot;: false, &quot;ping&quot;: &quot;pong&quot; } arm64-05 | SUCCESS =&gt; { &quot;changed&quot;: false, &quot;ping&quot;: &quot;pong&quot; } arm64-04 | SUCCESS =&gt; { &quot;changed&quot;: false, &quot;ping&quot;: &quot;pong&quot; } arm64-03 | SUCCESS =&gt; { &quot;changed&quot;: false, &quot;ping&quot;: &quot;pong&quot; } arm64-01 | SUCCESS =&gt; { &quot;changed&quot;: false, &quot;ping&quot;: &quot;pong&quot; }","tags":"","url":"ansible\/microk8s_setup.html"},{"title":"storage","text":"Table of Contents Storage #Storage Create a Logical volume using Ansible","tags":"","url":"ansible\/storage.html"},{"title":"docker","text":"Table of Contents Clickhose Docker Reference #Clickhose Docker #Reference https:\/\/hub.docker.com\/r\/clickhouse\/clickhouse-server\/","tags":"","url":"clickhouse\/docker.html"},{"title":"documentation","text":"Table of Contents Clickhouse Documentation Reference Setup #Clickhouse Documentation #Reference Install ClickHouse Effortlessly Deploying ClickHouse on Kubernetes: A Comprehensive Guide ClickHouse on Kubernetes Installing Clickhouse on a kubernetes cluster #Setup","tags":"","url":"clickhouse\/documentation.html"},{"title":"kubernetes operator","text":"Table of Contents ClickHouse Kubernetes Operator References Setup Quick Start Setup #( 02\/18\/24@10:18PM )( donbuddenbaum@donbs-imac ):~\/Documents\/clickhouse-operator\/deploy\/operator@master\u2714 #( 02\/18\/24@11:22PM )( donbuddenbaum@donbs-imac ):~\/Documents\/Kalaxy2@main\u2714 Tests #( 02\/18\/24@10:22PM )( donbuddenbaum@donbs-imac ):~\/Documents\/clickhouse-operator\/deploy\/operator@master\u2714 #( 02\/18\/24@10:31PM )( donbuddenbaum@donbs-imac ):~\/Documents\/Kalaxy2\/yaml\/clickhouse@main\u2717\u2717\u2717 #( 02\/18\/24@10:32PM )( donbuddenbaum@donbs-imac ):~\/Documents\/Kalaxy2\/yaml\/clickhouse@main\u2717\u2717\u2717 chi-demo-01-demo-01-0-0-0.chi-demo-01-demo-01-0-0.demo.svc.cluster.local :) chi-demo-01-demo-01-0-0-0.chi-demo-01-demo-01-0-0.demo.svc.cluster.local :) chi-demo-01-demo-01-0-0-0.chi-demo-01-demo-01-0-0.demo.svc.cluster.local :) chi-demo-01-demo-01-0-0-0.chi-demo-01-demo-01-0-0.demo.svc.cluster.local :) SELECT DISTINCT(pickup_ntaname) FROM trips chi-demo-01-demo-01-0-0-0.chi-demo-01-demo-01-0-0.demo.svc.cluster.local :) SELECT round(avg(tip_amount), 2) FROM trips chi-demo-01-demo-01-0-0-0.chi-demo-01-demo-01-0-0.demo.svc.cluster.local :) SELECT passenger_count, ceil(avg(total_amount),2) AS average_total_amount FROM trips GROUP BY passenger_count chi-demo-01-demo-01-0-0-0.chi-demo-01-demo-01-0-0.demo.svc.cluster.local :) CREATE DICTIONARY taxi_zone_dictionary(LocationID UInt16 DEFAULT 0,Borough String,Zone String,service_zone String) PRIMARY KEY LocationID SOURCE(HTTP(URL \u2018https:\/\/datasets-documentation.s3.eu-west-3.amazonaws.com\/nyc-taxi\/taxi_zone_lookup.csv\u2019 FORMAT \u2018CSVWithNames\u2019)) LIFETIME(MIN 0 MAX 0) LAYOUT(HASHED_ARRAY()) chi-demo-01-demo-01-0-0-0.chi-demo-01-demo-01-0-0.demo.svc.cluster.local :) SELECT dictGet(\u2018taxi_zone_dictionary\u2019, \u2018Borough\u2019, 132) chi-demo-01-demo-01-0-0-0.chi-demo-01-demo-01-0-0.demo.svc.cluster.local :) SELECT dictGet(\u2018taxi_zone_dictionary\u2019, \u2018Borough\u2019, 132) chi-demo-01-demo-01-0-0-0.chi-demo-01-demo-01-0-0.demo.svc.cluster.local :) SELECT count(1) AS total, dictGetOrDefault(\u2018taxi_zone_dictionary\u2019,\u2018Borough\u2019, toUInt64(pickup_nyct2010_gid), \u2018Unknown\u2019) AS borough_name FROM trips WHERE dropoff_nyct2010_gid = 132 OR dropoff_nyct2010_gid = 138 GROUP BY borough_name ORDER BY total DESC chi-demo-01-demo-01-0-0-0.chi-demo-01-demo-01-0-0.demo.svc.cluster.local :) SELECT count(1) AS total, Borough FROM trips JOIN taxi_zone_dictionary ON toUInt64(trips.pickup_nyct2010_gid) = taxi_zone_dictionary.LocationID WHERE dropoff_nyct2010_gid = 132 OR dropoff_nyct2010_gid = 138 GROUP BY Borough ORDER BY total DESC #ClickHouse Kubernetes Operator #References Quick Start Guides Effortlessly Deploying ClickHouse on Kubernetes: A Comprehensive Guide #Setup #Quick Start #Setup ##( 02\/18\/24@10:18PM )( donbuddenbaum@donbs-imac ):~\/Documents\/clickhouse-operator\/deploy\/operator@master\u2714 kubectl apply -f https:\/\/raw.githubusercontent.com\/Altinity\/clickhouse-operator\/master\/deploy\/operator\/clickhouse-operator-install-bundle.yaml customresourcedefinition.apiextensions.k8s.io\/clickhouseinstallations.clickhouse.altinity.com unchanged customresourcedefinition.apiextensions.k8s.io\/clickhouseinstallationtemplates.clickhouse.altinity.com unchanged customresourcedefinition.apiextensions.k8s.io\/clickhouseoperatorconfigurations.clickhouse.altinity.com unchanged customresourcedefinition.apiextensions.k8s.io\/clickhousekeeperinstallations.clickhouse-keeper.altinity.com unchanged serviceaccount\/clickhouse-operator unchanged clusterrole.rbac.authorization.k8s.io\/clickhouse-operator-kube-system unchanged clusterrolebinding.rbac.authorization.k8s.io\/clickhouse-operator-kube-system unchanged configmap\/etc-clickhouse-operator-files unchanged configmap\/etc-clickhouse-operator-confd-files configured configmap\/etc-clickhouse-operator-configd-files unchanged configmap\/etc-clickhouse-operator-templatesd-files unchanged configmap\/etc-clickhouse-operator-usersd-files unchanged secret\/clickhouse-operator configured deployment.apps\/clickhouse-operator unchanged service\/clickhouse-operator-metrics unchanged ##( 02\/18\/24@11:22PM )( donbuddenbaum@donbs-imac ):~\/Documents\/Kalaxy2@main\u2714 kubectl get all -n demo NAME READY STATUS RESTARTS AGE pod\/chi-demo-01-demo-01-0-0-0 1\/1 Running 0 56m NAME TYPE CLUSTER-IP EXTERNAL-IP PORT(S) AGE service\/chi-demo-01-demo-01-0-0 ClusterIP None &lt;none&gt; 9000\/TCP,8123\/TCP,9009\/TCP 56m service\/clickhouse-demo-01 LoadBalancer 10.152.183.114 192.168.2.21 8123:31182\/TCP,9000:31455\/TCP 56m NAME READY AGE statefulset.apps\/chi-demo-01-demo-01-0-0 1\/1 56m #Tests ##( 02\/18\/24@10:22PM )( donbuddenbaum@donbs-imac ):~\/Documents\/clickhouse-operator\/deploy\/operator@master\u2714 kubectl create namespace demo namespace\/demo created ##( 02\/18\/24@10:31PM )( donbuddenbaum@donbs-imac ):~\/Documents\/Kalaxy2\/yaml\/clickhouse@main\u2717\u2717\u2717 kubectl apply -f demo.yaml -n demo clickhouseinstallation.clickhouse.altinity.com\/demo-01 created ##( 02\/18\/24@10:32PM )( donbuddenbaum@donbs-imac ):~\/Documents\/Kalaxy2\/yaml\/clickhouse@main\u2717\u2717\u2717 kubectl exec -it chi-demo-01-demo-01-0-0-0 -n demo \u2013 clickhouse-client ClickHouse client version 24.1.5.6 (official build). Connecting to localhost:9000 as user default. Connected to ClickHouse server version 24.1.5. #chi-demo-01-demo-01-0-0-0.chi-demo-01-demo-01-0-0.demo.svc.cluster.local :) CREATE TABLE trips ( trip_id UInt32, vendor_id Enum8(\u20181\u2019 = 1, \u20182\u2019 = 2, \u20183\u2019 = 3, \u20184\u2019 = 4, \u2018CMT\u2019 = 5, \u2018VTS\u2019 = 6, \u2018DDS\u2019 = 7, \u2018B02512\u2019 = 10, \u2018B02598\u2019 = 11, \u2018B02617\u2019 = 12, \u2018B02682\u2019 = 13, \u2018B02764\u2019 = 14, \u2018\u2019 = 15), pickup_date Date, pickup_datetime DateTime, dropoff_date Date, dropoff_datetime DateTime, store_and_fwd_flag UInt8, rate_code_id UInt8, pickup_longitude Float64, pickup_latitude Float64, dropoff_longitude Float64, dropoff_latitude Float64, passenger_count UInt8, trip_distance Float64, fare_amount Float32, extra Float32, mta_tax Float32, tip_amount Float32, tolls_amount Float32, ehail_fee Float32, improvement_surcharge Float32, total_amount Float32, payment_type Enum8(\u2018UNK\u2019 = 0, \u2018CSH\u2019 = 1, \u2018CRE\u2019 = 2, \u2018NOC\u2019 = 3, \u2018DIS\u2019 = 4), trip_type UInt8, pickup FixedString(25), dropoff FixedString(25), cab_type Enum8(\u2018yellow\u2019 = 1, \u2018green\u2019 = 2, \u2018uber\u2019 = 3), pickup_nyct2010_gid Int8, pickup_ctlabel Float32, pickup_borocode Int8, pickup_ct2010 String, pickup_boroct2010 String, pickup_cdeligibil String, pickup_ntacode FixedString(4), pickup_ntaname String, pickup_puma UInt16, dropoff_nyct2010_gid UInt8, dropoff_ctlabel Float32, dropoff_borocode UInt8, dropoff_ct2010 String, dropoff_boroct2010 String, dropoff_cdeligibil String, dropoff_ntacode FixedString(4), dropoff_ntaname String, dropoff_puma UInt16 ) ENGINE = MergeTree PARTITION BY toYYYYMM(pickup_date) ORDER BY pickup_datetime Query id: 58068e7f-c033-434f-a6e6-d3022a6265d4 Ok. 0 rows in set. Elapsed: 0.015 sec. #chi-demo-01-demo-01-0-0-0.chi-demo-01-demo-01-0-0.demo.svc.cluster.local :) INSERT INTO trips SELECT * FROM s3( \u2018https:\/\/datasets-documentation.s3.eu-west-3.amazonaws.com\/nyc-taxi\/trips_{1..2}.gz\u2019, \u2018TabSeparatedWithNames\u2019, \u201c trip_id UInt32, vendor_id Enum8(\u20181\u2019 = 1, \u20182\u2019 = 2, \u20183\u2019 = 3, \u20184\u2019 = 4, \u2018CMT\u2019 = 5, \u2018VTS\u2019 = 6, \u2018DDS\u2019 = 7, \u2018B02512\u2019 = 10, \u2018B02598\u2019 = 11, \u2018B02617\u2019 = 12, \u2018B02682\u2019 = 13, \u2018B02764\u2019 = 14, \u2018\u2019 = 15), pickup_date Date, pickup_datetime DateTime, dropoff_date Date, dropoff_datetime DateTime, store_and_fwd_flag UInt8, rate_code_id UInt8, pickup_longitude Float64, pickup_latitude Float64, dropoff_longitude Float64, dropoff_latitude Float64, passenger_count UInt8, trip_distance Float64, fare_amount Float32, extra Float32, mta_tax Float32, tip_amount Float32, tolls_amount Float32, ehail_fee Float32, improvement_surcharge Float32, total_amount Float32, payment_type Enum8(\u2018UNK\u2019 = 0, \u2018CSH\u2019 = 1, \u2018CRE\u2019 = 2, \u2018NOC\u2019 = 3, \u2018DIS\u2019 = 4), trip_type UInt8, pickup FixedString(25), dropoff FixedString(25), cab_type Enum8(\u2018yellow\u2019 = 1, \u2018green\u2019 = 2, \u2018uber\u2019 = 3), pickup_nyct2010_gid Int8, pickup_ctlabel Float32, pickup_borocode Int8, pickup_ct2010 String, pickup_boroct2010 String, pickup_cdeligibil String, pickup_ntacode FixedString(4), pickup_ntaname String, pickup_puma UInt16, dropoff_nyct2010_gid UInt8, dropoff_ctlabel Float32, dropoff_borocode UInt8, dropoff_ct2010 String, dropoff_boroct2010 String, dropoff_cdeligibil String, dropoff_ntacode FixedString(4), dropoff_ntaname String, dropoff_puma UInt16 \u201c) SETTINGS input_format_try_infer_datetimes = 0 INSERT INTO trips SETTINGS input_format_try_infer_datetimes = 0 SELECT * FROM s3(\u2018https:\/\/datasets-documentation.s3.eu-west-3.amazonaws.com\/nyc-taxi\/trips_{1..2}.gz\u2019, \u2018TabSeparatedWithNames\u2019, \\n \\trip_id` UInt32,\\n `vendor_id` Enum8(\u20181\u2019 = 1, \u20182\u2019 = 2, \u20183\u2019 = 3, \u20184\u2019 = 4, \u2018CMT\u2019 = 5, \u2018VTS\u2019 = 6, \u2018DDS\u2019 = 7, \u2018B02512\u2019 = 10, \u2018B02598\u2019 = 11, \u2018B02617\u2019 = 12, \u2018B02682\u2019 = 13, \u2018B02764\u2019 = 14, \u2018\u2019 = 15),\\n `pickup_date` Date,\\n `pickup_datetime` DateTime,\\n `dropoff_date` Date,\\n `dropoff_datetime` DateTime,\\n `store_and_fwd_flag` UInt8,\\n `rate_code_id` UInt8,\\n `pickup_longitude` Float64,\\n `pickup_latitude` Float64,\\n `dropoff_longitude` Float64,\\n `dropoff_latitude` Float64,\\n `passenger_count` UInt8,\\n `trip_distance` Float64,\\n `fare_amount` Float32,\\n `extra` Float32,\\n `mta_tax` Float32,\\n `tip_amount` Float32,\\n `tolls_amount` Float32,\\n `ehail_fee` Float32,\\n `improvement_surcharge` Float32,\\n `total_amount` Float32,\\n `payment_type` Enum8(\u2018UNK\u2019 = 0, \u2018CSH\u2019 = 1, \u2018CRE\u2019 = 2, \u2018NOC\u2019 = 3, \u2018DIS\u2019 = 4),\\n `trip_type` UInt8,\\n `pickup` FixedString(25),\\n `dropoff` FixedString(25),\\n `cab_type` Enum8(\u2018yellow\u2019 = 1, \u2018green\u2019 = 2, \u2018uber\u2019 = 3),\\n `pickup_nyct2010_gid` Int8,\\n `pickup_ctlabel` Float32,\\n `pickup_borocode` Int8,\\n `pickup_ct2010` String,\\n `pickup_boroct2010` String,\\n `pickup_cdeligibil` String,\\n `pickup_ntacode` FixedString(4),\\n `pickup_ntaname` String,\\n `pickup_puma` UInt16,\\n `dropoff_nyct2010_gid` UInt8,\\n `dropoff_ctlabel` Float32,\\n `dropoff_borocode` UInt8,\\n `dropoff_ct2010` String,\\n `dropoff_boroct2010` String,\\n `dropoff_cdeligibil` String,\\n `dropoff_ntacode` FixedString(4),\\n `dropoff_ntaname` String,\\n `dropoff_puma` UInt16\\n`) SETTINGS input_format_try_infer_datetimes = 0 Query id: 99d6ebed-032e-4138-8edc-342f5db144f6 Ok. 0 rows in set. Elapsed: 30.854 sec. Processed 2.00 million rows, 163.07 MB (64.81 thousand rows\/s., 5.29 MB\/s.) Peak memory usage: 1.20 GiB. #chi-demo-01-demo-01-0-0-0.chi-demo-01-demo-01-0-0.demo.svc.cluster.local :) SELECT count() FROM trips Query id: be0ab8c1-dd68-4f8a-9e25-3468c44566a9 \u250c\u2500count()\u2500\u2510 \u2502 1999657 \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 1 row in set. Elapsed: 0.003 sec. #chi-demo-01-demo-01-0-0-0.chi-demo-01-demo-01-0-0.demo.svc.cluster.local :) SELECT DISTINCT(pickup_ntaname) FROM trips SELECT DISTINCT pickup_ntaname FROM trips Query id: ec13863e-cc72-4495-9faf-60d86e5084d9 \u250c\u2500pickup_ntaname\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 Upper East Side-Carnegie Hill \u2502 \u2502 East Village \u2502 \u2502 SoHo-TriBeCa-Civic Center-Little Italy \u2502 \u2502 Lincoln Square \u2502 \u2502 Battery Park City-Lower Manhattan \u2502 \u2502 Midtown-Midtown South \u2502 \u2502 North Side-South Side \u2502 \u2502 Gramercy \u2502 \u2502 Murray Hill-Kips Bay \u2502 \u2502 Airport \u2502 \u2502 Clinton \u2502 \u2502 Central Harlem South \u2502 \u2502 Hudson Yards-Chelsea-Flatiron-Union Square \u2502 \u2502 West Village \u2502 \u2502 West Concourse \u2502 \u2502 Lenox Hill-Roosevelt Island \u2502 \u2502 Woodlawn-Wakefield \u2502 \u2502 Lower East Side \u2502 \u2502 Chinatown \u2502 \u2502 Upper West Side \u2502 \u2502 DUMBO-Vinegar Hill-Downtown Brooklyn-Boerum Hill \u2502 \u2502 \u2502 \u2502 Fort Greene \u2502 \u2502 Park Slope-Gowanus \u2502 \u2502 East Harlem North \u2502 \u2502 Turtle Bay-East Midtown \u2502 \u2502 Greenpoint \u2502 \u2502 East Williamsburg \u2502 \u2502 East Concourse-Concourse Village \u2502 \u2502 Astoria \u2502 \u2502 North Corona \u2502 \u2502 South Ozone Park \u2502 \u2502 Yorkville \u2502 \u2502 Crown Heights South \u2502 \u2502 Manhattanville \u2502 \u2502 Jackson Heights \u2502 \u2502 Kensington-Ocean Parkway \u2502 \u2502 Queensbridge-Ravenswood-Long Island City \u2502 \u2502 Elmhurst \u2502 \u2502 Carroll Gardens-Columbia Street-Red Hook \u2502 \u2502 Morningside Heights \u2502 \u2502 Bedford \u2502 \u2502 Woodside \u2502 \u2502 Old Astoria \u2502 \u2502 Ocean Hill \u2502 \u2502 Central Harlem North-Polo Grounds \u2502 \u2502 Hunters Point-Sunnyside-West Maspeth \u2502 \u2502 Rego Park \u2502 \u2502 Steinway \u2502 \u2502 Stuyvesant Town-Cooper Village \u2502 \u2502 Hamilton Heights \u2502 \u2502 East Harlem South \u2502 \u2502 park-cemetery-etc-Manhattan \u2502 \u2502 Kew Gardens \u2502 \u2502 Jamaica \u2502 \u2502 Sunset Park West \u2502 \u2502 Washington Heights South \u2502 \u2502 park-cemetery-etc-Queens \u2502 \u2502 Windsor Terrace \u2502 \u2502 Williamsburg \u2502 \u2502 Arden Heights \u2502 \u2502 Mott Haven-Port Morris \u2502 \u2502 Elmhurst-Maspeth \u2502 \u2502 Clinton Hill \u2502 \u2502 Newark Airport \u2502 \u2502 Hunts Point \u2502 \u2502 Brooklyn Heights-Cobble Hill \u2502 \u2502 Stuyvesant Heights \u2502 \u2502 Richmond Hill \u2502 \u2502 East Elmhurst \u2502 \u2502 Flushing \u2502 \u2502 Briarwood-Jamaica Hills \u2502 \u2502 Melrose South-Mott Haven North \u2502 \u2502 Glendale \u2502 \u2502 Spuyten Duyvil-Kingsbridge \u2502 \u2502 Crown Heights North \u2502 \u2502 South Jamaica \u2502 \u2502 Prospect Heights \u2502 \u2502 Kingsbridge Heights \u2502 \u2502 Prospect Lefferts Gardens-Wingate \u2502 \u2502 Bushwick South \u2502 \u2502 Kew Gardens Hills \u2502 \u2502 East New York \u2502 \u2502 Bay Ridge \u2502 \u2502 Sheepshead Bay-Gerritsen Beach-Manhattan Beach \u2502 \u2502 Forest Hills \u2502 \u2502 Baisley Park \u2502 \u2502 Marble Hill-Inwood \u2502 \u2502 park-cemetery-etc-Brooklyn \u2502 \u2502 Ozone Park \u2502 \u2502 Bushwick North \u2502 \u2502 Brownsville \u2502 \u2502 Jamaica Estates-Holliswood \u2502 \u2502 Flatbush \u2502 \u2502 University Heights-Morris Heights \u2502 \u2502 Murray Hill \u2502 \u2502 Springfield Gardens South-Brookville \u2502 \u2502 Bedford Park-Fordham North \u2502 \u2502 Ocean Parkway South \u2502 \u2502 Rosedale \u2502 \u2502 Corona \u2502 \u2502 Mount Hope \u2502 \u2502 Belmont \u2502 \u2502 Maspeth \u2502 \u2502 Ridgewood \u2502 \u2502 Woodhaven \u2502 \u2502 park-cemetery-etc-Bronx \u2502 \u2502 Pelham Bay-Country Club-City Island \u2502 \u2502 Borough Park \u2502 \u2502 Bensonhurst East \u2502 \u2502 Highbridge \u2502 \u2502 Washington Heights North \u2502 \u2502 Middle Village \u2502 \u2502 Homecrest \u2502 \u2502 Midwood \u2502 \u2502 Hammels-Arverne-Edgemere \u2502 \u2502 East New York (Pennsylvania Ave) \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u250c\u2500pickup_ntaname\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 Bellerose \u2502 \u2502 Rugby-Remsen Village \u2502 \u2502 Dyker Heights \u2502 \u2502 Norwood \u2502 \u2502 Brighton Beach \u2502 \u2502 Canarsie \u2502 \u2502 Flatlands \u2502 \u2502 Cypress Hills-City Line \u2502 \u2502 Claremont-Bathgate \u2502 \u2502 Sunset Park East \u2502 \u2502 Fresh Meadows-Utopia \u2502 \u2502 Pomonok-Flushing Heights-Hillcrest \u2502 \u2502 East Flatbush-Farragut \u2502 \u2502 Great Kills \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u250c\u2500pickup_ntaname\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 Gravesend \u2502 \u2502 Soundview-Castle Hill-Clason Point-Harding Park \u2502 \u2502 Georgetown-Marine Park-Bergen Beach-Mill Basin \u2502 \u2502 Springfield Gardens North \u2502 \u2502 Queensboro Hill \u2502 \u2502 Erasmus \u2502 \u2502 Van Cortlandt Village \u2502 \u2502 Bayside-Bayside Hills \u2502 \u2502 West Farms-Bronx River \u2502 \u2502 Morrisania-Melrose \u2502 \u2502 West New Brighton-New Brighton-St. George \u2502 \u2502 East Tremont \u2502 \u2502 Queens Village \u2502 \u2502 Soundview-Bruckner \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u250c\u2500pickup_ntaname\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 Eastchester-Edenwald-Baychester \u2502 \u2502 Bronxdale \u2502 \u2502 Westchester-Unionport \u2502 \u2502 College Point \u2502 \u2502 Laurelton \u2502 \u2502 Williamsbridge-Olinville \u2502 \u2502 Old Town-Dongan Hills-South Beach \u2502 \u2502 Van Nest-Morris Park-Westchester Square \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u250c\u2500pickup_ntaname\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 Seagate-Coney Island \u2502 \u2502 Stapleton-Rosebank \u2502 \u2502 Schuylerville-Throgs Neck-Edgewater Park \u2502 \u2502 Bensonhurst West \u2502 \u2502 Parkchester \u2502 \u2502 Madison \u2502 \u2502 Crotona Park East \u2502 \u2502 St. Albans \u2502 \u2502 Fordham South \u2502 \u2502 East Flushing \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u250c\u2500pickup_ntaname\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 Breezy Point-Belle Harbor-Rockaway Park-Broad Channel \u2502 \u2502 Bath Beach \u2502 \u2502 Pelham Parkway \u2502 \u2502 Co-op City \u2502 \u2502 Longwood \u2502 \u2502 North Riverdale-Fieldston-Riverdale \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u250c\u2500pickup_ntaname\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 Auburndale \u2502 \u2502 Grasmere-Arrochar-Ft. Wadsworth \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u250c\u2500pickup_ntaname\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 Allerton-Pelham Gardens \u2502 \u2502 West Brighton \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u250c\u2500pickup_ntaname\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 Whitestone \u2502 \u2502 Lindenwood-Howard Beach \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u250c\u2500pickup_ntaname\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 New Dorp-Midland Beach \u2502 \u2502 Ft. Totten-Bay Terrace-Clearview \u2502 \u2502 Glen Oaks-Floral Park-New Hyde Park \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u250c\u2500pickup_ntaname\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 New Springville-Bloomfield-Travis \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u250c\u2500pickup_ntaname\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 Douglas Manor-Douglaston-Little Neck \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u250c\u2500pickup_ntaname\u2500\u2510 \u2502 Hollis \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u250c\u2500pickup_ntaname\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 Annadale-Huguenot-Prince's Bay-Eltingville \u2502 \u2502 Cambria Heights \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u250c\u2500pickup_ntaname\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 Mariner's Harbor-Arlington-Port Ivory-Graniteville \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u250c\u2500pickup_ntaname\u2500\u2500\u2510 \u2502 Oakland Gardens \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u250c\u2500pickup_ntaname\u2500\u2510 \u2502 Starrett City \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u250c\u2500pickup_ntaname\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 Todt Hill-Emerson Hill-Heartland Village-Lighthouse Hill \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u250c\u2500pickup_ntaname\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 Far Rockaway-Bayswater \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u250c\u2500pickup_ntaname\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 New Brighton-Silver Lake \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u250c\u2500pickup_ntaname\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 Grymes Hill-Clifton-Fox Hills \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 190 rows in set. Elapsed: 0.039 sec. Processed 2.00 million rows, 60.32 MB (51.59 million rows\/s., 1.56 GB\/s.) Peak memory usage: 12.67 MiB. #chi-demo-01-demo-01-0-0-0.chi-demo-01-demo-01-0-0.demo.svc.cluster.local :) SELECT round(avg(tip_amount), 2) FROM trips SELECT round(avg(tip_amount), 2) FROM trips Query id: 483688f5-7c70-4fde-ae8e-5fcd7c99a179 \u250c\u2500round(avg(tip_amount), 2)\u2500\u2510 \u2502 1.68 \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 1 row in set. Elapsed: 0.018 sec. Processed 2.00 million rows, 8.00 MB (113.75 million rows\/s., 455.00 MB\/s.) Peak memory usage: 129.33 KiB. #chi-demo-01-demo-01-0-0-0.chi-demo-01-demo-01-0-0.demo.svc.cluster.local :) SELECT passenger_count, ceil(avg(total_amount),2) AS average_total_amount FROM trips GROUP BY passenger_count SELECT passenger_count, ceil(avg(total_amount), 2) AS average_total_amount FROM trips GROUP BY passenger_count Query id: c60c9f21-c370-4c11-bd34-ae4a53008010 \u250c\u2500passenger_count\u2500\u252c\u2500average_total_amount\u2500\u2510 \u2502 0 \u2502 22.69 \u2502 \u2502 1 \u2502 15.97 \u2502 \u2502 2 \u2502 17.15 \u2502 \u2502 3 \u2502 16.76 \u2502 \u2502 4 \u2502 17.33 \u2502 \u2502 5 \u2502 16.35 \u2502 \u2502 6 \u2502 16.04 \u2502 \u2502 7 \u2502 59.8 \u2502 \u2502 8 \u2502 36.41 \u2502 \u2502 9 \u2502 9.81 \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 10 rows in set. Elapsed: 0.021 sec. Processed 2.00 million rows, 10.00 MB (97.00 million rows\/s., 484.98 MB\/s.) Peak memory usage: 1.06 MiB. #chi-demo-01-demo-01-0-0-0.chi-demo-01-demo-01-0-0.demo.svc.cluster.local :) CREATE DICTIONARY taxi_zone_dictionary(LocationID UInt16 DEFAULT 0,Borough String,Zone String,service_zone String) PRIMARY KEY LocationID SOURCE(HTTP(URL \u2018https:\/\/datasets-documentation.s3.eu-west-3.amazonaws.com\/nyc-taxi\/taxi_zone_lookup.csv\u2019 FORMAT \u2018CSVWithNames\u2019)) LIFETIME(MIN 0 MAX 0) LAYOUT(HASHED_ARRAY()) CREATE DICTIONARY taxi_zone_dictionary ( `LocationID` UInt16 DEFAULT 0, `Borough` String, `Zone` String, `service_zone` String ) PRIMARY KEY LocationID SOURCE(HTTP(URL 'https:\/\/datasets-documentation.s3.eu-west-3.amazonaws.com\/nyc-taxi\/taxi_zone_lookup.csv' FORMAT 'CSVWithNames')) LIFETIME(MIN 0 MAX 0) LAYOUT(HASHED_ARRAY()) Query id: 95f77c45-6815-4a5c-b17b-8fb1d318b9c2 Ok. 0 rows in set. Elapsed: 0.005 sec. #chi-demo-01-demo-01-0-0-0.chi-demo-01-demo-01-0-0.demo.svc.cluster.local :) SELECT dictGet(\u2018taxi_zone_dictionary\u2019, \u2018Borough\u2019, 132) SELECT dictGet('taxi_zone_dictionary', 'Borough', 132) Query id: 4497c71a-9bd5-4a1d-b189-2a0f637a54d0 \u250c\u2500dictGet('taxi_zone_dictionary', 'Borough', 132)\u2500\u2510 \u2502 Queens \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 1 row in set. Elapsed: 0.002 sec. #chi-demo-01-demo-01-0-0-0.chi-demo-01-demo-01-0-0.demo.svc.cluster.local :) SELECT dictGet(\u2018taxi_zone_dictionary\u2019, \u2018Borough\u2019, 132) SELECT dictGet('taxi_zone_dictionary', 'Borough', 132) Query id: 4fee18cd-3c94-4288-9234-48607279f482 \u250c\u2500dictGet('taxi_zone_dictionary', 'Borough', 132)\u2500\u2510 \u2502 Queens \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 1 row in set. Elapsed: 0.002 sec. #chi-demo-01-demo-01-0-0-0.chi-demo-01-demo-01-0-0.demo.svc.cluster.local :) SELECT count(1) AS total, dictGetOrDefault(\u2018taxi_zone_dictionary\u2019,\u2018Borough\u2019, toUInt64(pickup_nyct2010_gid), \u2018Unknown\u2019) AS borough_name FROM trips WHERE dropoff_nyct2010_gid = 132 OR dropoff_nyct2010_gid = 138 GROUP BY borough_name ORDER BY total DESC SELECT count(1) AS total, dictGetOrDefault('taxi_zone_dictionary', 'Borough', toUInt64(pickup_nyct2010_gid), 'Unknown') AS borough_name FROM trips WHERE (dropoff_nyct2010_gid = 132) OR (dropoff_nyct2010_gid = 138) GROUP BY borough_name ORDER BY total DESC Query id: 91476f58-cd09-45cb-bb7a-11806edbe6bf \u250c\u2500total\u2500\u252c\u2500borough_name\u2500\u2500\u2510 \u2502 23683 \u2502 Unknown \u2502 \u2502 7053 \u2502 Manhattan \u2502 \u2502 6828 \u2502 Brooklyn \u2502 \u2502 4458 \u2502 Queens \u2502 \u2502 2670 \u2502 Bronx \u2502 \u2502 554 \u2502 Staten Island \u2502 \u2502 53 \u2502 EWR \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 7 rows in set. Elapsed: 0.015 sec. Processed 2.00 million rows, 4.00 MB (130.46 million rows\/s., 260.91 MB\/s.) Peak memory usage: 804.58 KiB. #chi-demo-01-demo-01-0-0-0.chi-demo-01-demo-01-0-0.demo.svc.cluster.local :) SELECT count(1) AS total, Borough FROM trips JOIN taxi_zone_dictionary ON toUInt64(trips.pickup_nyct2010_gid) = taxi_zone_dictionary.LocationID WHERE dropoff_nyct2010_gid = 132 OR dropoff_nyct2010_gid = 138 GROUP BY Borough ORDER BY total DESC SELECT count(1) AS total, Borough FROM trips INNER JOIN taxi_zone_dictionary ON toUInt64(trips.pickup_nyct2010_gid) = taxi_zone_dictionary.LocationID WHERE (dropoff_nyct2010_gid = 132) OR (dropoff_nyct2010_gid = 138) GROUP BY Borough ORDER BY total DESC Query id: 0c387dd7-c25e-4b62-a9d3-71981c21f2c0 \u250c\u2500total\u2500\u252c\u2500Borough\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 7053 \u2502 Manhattan \u2502 \u2502 6828 \u2502 Brooklyn \u2502 \u2502 4458 \u2502 Queens \u2502 \u2502 2670 \u2502 Bronx \u2502 \u2502 554 \u2502 Staten Island \u2502 \u2502 53 \u2502 EWR \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 6 rows in set. Elapsed: 0.049 sec. Processed 2.00 million rows, 4.00 MB (41.12 million rows\/s., 82.25 MB\/s.) Peak memory usage: 496.75 KiB.","tags":"","url":"clickhouse\/kubernetes_operator.html"},{"title":"documentation","text":"Table of Contents Documentation Generate #( 05\/03\/22@ 2:00PM )( dbuddenbaum@donb-mbp4 ):~\/Documents\/rpi4\/kalaxy@main\u2717\u2717\u2717 Hosting site in a file in NGINX Multi Arc Build NGINX with static site #( 01\/10\/23@ 3:50PM )( donbuddenbaum@donbs-imac ):~\/Documents\/rPi4\/kalaxy@main\u2717\u2717\u2717 Single Arch Build NGINX with static site #( 07\/29\/22@ 5:23PM )( donbuddenbaum@donbs-imac ):~\/Documents\/rPi4\/kalaxy@main\u2717\u2717\u2717 #( 08\/22\/22@ 5:07PM )( donbuddenbaum@donbs-imac ):~\/Documents\/rPi4\/kalaxy\/yaml\/nginx\/k8s-doc-to-nginx@main\u2717\u2717\u2717 #( 08\/22\/22@ 5:19PM )( donbuddenbaum@donbs-imac ):~\/Documents\/rPi4\/kalaxy\/yaml\/nginx\/k8s-doc-to-nginx@main\u2717\u2717\u2717 #( 08\/22\/22@ 5:20PM )( donbuddenbaum@donbs-imac ):~\/Documents\/rPi4\/kalaxy\/yaml\/nginx\/k8s-doc-to-nginx@main\u2717\u2717\u2717 #( 08\/22\/22@ 5:31PM )( donbuddenbaum@donbs-imac ):~\/Documents\/rPi4\/kalaxy@main\u2717\u2717\u2717 Updating documentation #Documentation daux.io #Generate ##( 05\/03\/22@ 2:00PM )( dbuddenbaum@donb-mbp4 ):~\/Documents\/rpi4\/kalaxy@main\u2717\u2717\u2717 docker run \u2013rm -it -w \/build -v \u201c$PWD\u201d:\/build daux\/daux.io daux generate -s markdown -d docs Copying Static assets ... [ OK ] Generating ... - alvearie\/alvearie.html [ OK ] - alvearie\/cohort_integration_docker.html [ OK ] - alvearie\/cohort_fhir_integration.html [ OK ] - alvearie\/cohorting.html [ OK ] - alvearie\/fhirserver.html [ OK ] - alvearie\/jupyter.html [ OK ] - ansible\/ansible_automation.html [ OK ] - ansible\/blog.html [ OK ] - ansible\/storage.html [ OK ] - boinc\/boinc.html [ OK ] - docker\/docker_cmds.html [ OK ] - docker\/multi_arch_docker.html [ OK ] - docker\/rpi4_docker.html [ OK ] - file_system\/ceph.html [ OK ] - file_system\/crd.html [ OK ] - file_system\/longhorn.html [ OK ] - file_system\/nfs.html [ OK ] - file_system\/rook_ceph.html [ OK ] - file_system\/samba.html [ OK ] - helm\/helm.html [ OK ] - images\/cluster-initial-up.png [ OK ] - images\/cohort-controllers.png [ OK ] - images\/dashboard.png [ OK ] - images\/fhir-server_context.png [ OK ] - images\/k8s-dashboard-1110x0694.png [ OK ] - images\/kubernetes-dashboard-args.png [ OK ] - images\/kubernetes-dashboard-ttl.png [ OK ] - images\/nodej_to_nginx.png [ OK ] - images\/raspi-array-0510x0905.jpg [ OK ] - images\/set_prometheus_server_datasource.png [ OK ] - images\/traeficdashboard.png [ OK ] - k8s\/containerd.html [ OK ] - k8s\/k8s.html [ OK ] - k8s\/kube_upgrade.html [ OK ] - k8s\/microk8s.html [ OK ] - k8s\/podnodeselector.html [ OK ] - k8s\/upgrade_nodes.html [ OK ] - knative\/knative.html [ OK ] - knative\/knative_examples.html [ OK ] - microk8s\/ansible\/microk8s_setup.html [ OK ] - microk8s\/certificates\/certmanager.html [ OK ] - microk8s\/dashboard\/dashboard.html [ OK ] - microk8s\/dashboard\/k8s_dashboard.html [ OK ] - microk8s\/dashboard\/microk8s_dashboard.html [ OK ] - microk8s\/metallb\/k8s_metallb.html [ OK ] - microk8s\/metallb\/metalLb.html [ OK ] - monitoring\/monitoring.html [ OK ] - mysite\/mysite.html [ OK ] - new_relic\/newrelic.html [ OK ] - public_IP\/publicUrls.html [ OK ] - README.html [ OK ] - references\/documentation.html [ OK ] - references\/mediumlinks.html [ OK ] - references\/youtube.html [ OK ] - setup\/bonded_NIC.html [ OK ] - setup\/notes.html [ OK ] - setup\/README.html [ OK ] - setup\/rpi_usb_ubuntu.html [ OK ] - setup\/rPi4_usb.html [ OK ] - sql\/mysql.html [ OK ] - sql\/progressSQL.html [ OK ] - traefik\/traefik.html [ OK ] - utilities\/k9s.html [ OK ] - utilities\/krew.html [ OK ] - utilities\/kube_setup.html [ OK ] - utilities\/kube_visualizer.html [ OK ] - utilities\/kube_cmds.html [ OK ] - utilities\/kubescrape.html [ OK ] - utilities\/python.html [ OK ] - utilities\/ssh.html #Hosting site in a file in NGINX #Multi Arc Build NGINX with static site ##( 01\/10\/23@ 3:50PM )( donbuddenbaum@donbs-imac ):~\/Documents\/rPi4\/kalaxy@main\u2717\u2717\u2717 docker buildx create \u2013use docker buildx build \u2013platform linux\/amd64,linux\/arm64 -f yaml\/nginx-docs\/k8s-doc-to-nginx\/nginx\/Dockerfile -t donb4iu\/mynginx_docs \u2013push . [+] Building 92.2s (12\/12) FINISHED =&gt; [internal] load build definition from Dockerfile 0.0s =&gt; =&gt; transferring dockerfile: 80B 0.0s =&gt; [internal] load .dockerignore 0.0s =&gt; =&gt; transferring context: 157B 0.0s =&gt; [linux\/arm64 internal] load metadata for docker.io\/library\/nginx:latest 2.6s =&gt; [linux\/amd64 internal] load metadata for docker.io\/library\/nginx:latest 2.6s =&gt; [auth] library\/nginx:pull token for registry-1.docker.io 0.0s =&gt; [linux\/arm64 1\/2] FROM docker.io\/library\/nginx@sha256:0047b729188a15da49380d9506d65959cce6d40291ccfb4e039f5dc7efd33286 12.4s =&gt; =&gt; resolve docker.io\/library\/nginx@sha256:0047b729188a15da49380d9506d65959cce6d40291ccfb4e039f5dc7efd33286 0.1s =&gt; =&gt; sha256:395a946c3309e7c3158fd712d7168056e3b7824fd7dfe6fdac53a82bc3fef8f5 772B \/ 772B 0.2s =&gt; =&gt; sha256:d48994bc2006b3d4a992f0435d3da2406ec5b789b66f67b2707c102bc9d2e99c 1.41kB \/ 1.41kB 0.3s =&gt; =&gt; sha256:b576e4a56718c7c91c2324bebaeb3a27819b1dc55a7854f2549c9ae53e3fc8f9 957B \/ 957B 0.3s =&gt; =&gt; sha256:b9e33cc8aa8c7049ee74b17da1b0121bbee92b33dd70beddb9e7afd745a3cd69 626B \/ 626B 0.2s =&gt; =&gt; sha256:3c419414ca9e1744a592d3379a913e0b03f596cba3cbb9e48e544931ac8e1d93 25.39MB \/ 25.39MB 8.0s =&gt; =&gt; sha256:4b7f5b2a311310809ab89d92f6f71b0462722fe855d3b92c93098a528aa08791 30.04MB \/ 30.04MB 8.9s =&gt; =&gt; extracting sha256:4b7f5b2a311310809ab89d92f6f71b0462722fe855d3b92c93098a528aa08791 2.0s =&gt; =&gt; extracting sha256:3c419414ca9e1744a592d3379a913e0b03f596cba3cbb9e48e544931ac8e1d93 1.1s =&gt; =&gt; extracting sha256:b9e33cc8aa8c7049ee74b17da1b0121bbee92b33dd70beddb9e7afd745a3cd69 0.0s =&gt; =&gt; extracting sha256:b576e4a56718c7c91c2324bebaeb3a27819b1dc55a7854f2549c9ae53e3fc8f9 0.0s =&gt; =&gt; extracting sha256:395a946c3309e7c3158fd712d7168056e3b7824fd7dfe6fdac53a82bc3fef8f5 0.0s =&gt; =&gt; extracting sha256:d48994bc2006b3d4a992f0435d3da2406ec5b789b66f67b2707c102bc9d2e99c 0.0s =&gt; [linux\/amd64 1\/2] FROM docker.io\/library\/nginx@sha256:0047b729188a15da49380d9506d65959cce6d40291ccfb4e039f5dc7efd33286 0.1s =&gt; =&gt; resolve docker.io\/library\/nginx@sha256:0047b729188a15da49380d9506d65959cce6d40291ccfb4e039f5dc7efd33286 0.1s =&gt; [internal] load build context 0.1s =&gt; =&gt; transferring context: 13.18kB 0.1s =&gt; CACHED [linux\/amd64 2\/2] COPY \/docs \/usr\/share\/nginx\/html 0.0s =&gt; [linux\/arm64 2\/2] COPY \/docs \/usr\/share\/nginx\/html 0.7s =&gt; exporting to image 76.4s =&gt; =&gt; exporting layers 0.9s =&gt; =&gt; exporting manifest sha256:5de25b6df58dc43d36675f3d193f2612262690ac31773bd5ea88b3410a39c79f 0.0s =&gt; =&gt; exporting config sha256:ecbd04a1f6f460526ad56f17c81ccdee945c8ad71e25dafe02f402a51e7da0c3 0.0s =&gt; =&gt; exporting manifest sha256:d2017164c15212fef955de57f96d4462e85ebf78f3e6cc5ec0758fad14ee22ad 0.0s =&gt; =&gt; exporting config sha256:ed6af09d02b9ea2aa099e1422cf05d91ad0f3b8da89b9ceb93b54c7da8f2cc3d 0.0s =&gt; =&gt; exporting manifest list sha256:fa8130d2f4322d2c5305210c036c79fa2422ca7f03d9e1fd0ecc15eb143472b5 0.0s =&gt; =&gt; pushing layers 74.2s =&gt; =&gt; pushing manifest for docker.io\/donb4iu\/mynginx_docs:latest@sha256:fa8130d2f4322d2c5305210c036c79fa2422ca7f03d9e1fd0ecc15eb143472b5 1.3s =&gt; [auth] donb4iu\/mynginx_docs:pull,push token for registry-1.docker.io #Single Arch Build NGINX with static site Demystifying Persistent Volumes and Persistent Volume Claims ##( 07\/29\/22@ 5:23PM )( donbuddenbaum@donbs-imac ):~\/Documents\/rPi4\/kalaxy@main\u2717\u2717\u2717 docker build -f yaml\/nginx-docs\/k8s-doc-to-nginx\/nginx\/Dockerfile -t donb4iu\/mynginx_docs . [+] Building 0.5s (7\/7) FINISHED =&gt; [internal] load build definition from Dockerfile 0.0s =&gt; =&gt; transferring dockerfile: 36B 0.0s =&gt; [internal] load .dockerignore 0.0s =&gt; =&gt; transferring context: 126B 0.0s =&gt; [internal] load metadata for docker.io\/library\/nginx:latest 0.4s =&gt; [internal] load build context 0.0s =&gt; =&gt; transferring context: 8.10kB 0.0s =&gt; [1\/2] FROM docker.io\/library\/nginx@sha256:bd06dfe1f8f7758debd49d3876023992d41842fd8921565aed315a678a309982 0.0s =&gt; CACHED [2\/2] COPY \/docs \/usr\/share\/nginx\/html 0.0s =&gt; exporting to image 0.0s =&gt; =&gt; exporting layers 0.0s =&gt; =&gt; writing image sha256:676ea3c57ea7bf2d3a49cbba8f9069f2d18e751a42779a2a9e3a367b0233252f 0.0s =&gt; =&gt; naming to docker.io\/donb4iu\/mynginx_docs 0.0s Use 'docker scan' to run Snyk tests against images to find vulnerabilities and learn how to fix them ##( 08\/22\/22@ 5:07PM )( donbuddenbaum@donbs-imac ):~\/Documents\/rPi4\/kalaxy\/yaml\/nginx\/k8s-doc-to-nginx@main\u2717\u2717\u2717 kubectl apply -f ns.yaml namespace\/documentation created ##( 08\/22\/22@ 5:19PM )( donbuddenbaum@donbs-imac ):~\/Documents\/rPi4\/kalaxy\/yaml\/nginx\/k8s-doc-to-nginx@main\u2717\u2717\u2717 kubectl apply -f nginx-doc-deployment.yaml deployment.apps\/nginx created ##( 08\/22\/22@ 5:20PM )( donbuddenbaum@donbs-imac ):~\/Documents\/rPi4\/kalaxy\/yaml\/nginx\/k8s-doc-to-nginx@main\u2717\u2717\u2717 kubectl apply -f nginx-doc-service.yaml service\/nginx created ##( 08\/22\/22@ 5:31PM )( donbuddenbaum@donbs-imac ):~\/Documents\/rPi4\/kalaxy@main\u2717\u2717\u2717 kubectl get services -n documentation NAME TYPE CLUSTER-IP EXTERNAL-IP PORT(S) AGE nginx LoadBalancer 10.152.183.178 192.168.2.25 3001:32512\/TCP 16m #Updating documentation kubectl scale -n documentation deployment nginx \u2013replicas=0 kubectl scale -n documentation deployment nginx \u2013replicas=1","tags":"","url":"documentation\/documentation.html"},{"title":"microk8s node","text":"Table of Contents Remove Microk8s node Reference Remove Microk8s dbuddenbaum@arm64-02:~$ microk8s leave dbuddenbaum@arm64-02:~$ sudo microk8s stop dbuddenbaum@arm64-01:~$ microk8s remove-node arm64-02 dbuddenbaum@arm64-02:~$ sudo microk8s disable dbuddenbaum@arm64-02:~$ sudo snap remove microk8s dbuddenbaum@arm64-02:~$ sudo rm -rf \/var\/snap\/microk8s\/ dbuddenbaum@arm64-02:~$ sudo rm -rf \/var\/snap\/microk8s-common\/ dbuddenbaum@arm64-02:~$ ps aux | grep microk8s dbuddenbaum@arm64-02:~$ sudo rm -rf \/etc\/kubernetes\/ #Remove Microk8s node #Reference How to Uninstall MicroK8s on Ubuntu 20.04 #Remove Microk8s #dbuddenbaum@arm64-02:~$ microk8s leave Configuring services. Generating new cluster certificates. Waiting for node to start. #dbuddenbaum@arm64-02:~$ sudo microk8s stop Stopped. #dbuddenbaum@arm64-01:~$ microk8s remove-node arm64-02 #dbuddenbaum@arm64-02:~$ sudo microk8s disable Usage: microk8s disable [OPTIONS] ADDONS... Try &quot;microk8s disable -h&quot; for help. Error: Missing argument &quot;ADDONS...&quot;. #dbuddenbaum@arm64-02:~$ sudo snap remove microk8s microk8s removed #dbuddenbaum@arm64-02:~$ sudo rm -rf \/var\/snap\/microk8s\/ #dbuddenbaum@arm64-02:~$ sudo rm -rf \/var\/snap\/microk8s-common\/ #dbuddenbaum@arm64-02:~$ ps aux | grep microk8s dbudden+ 33720 0.0 0.0 5968 664 pts\/0 S+ 15:43 0:00 grep --color=auto microk8s #dbuddenbaum@arm64-02:~$ sudo rm -rf \/etc\/kubernetes\/","tags":"","url":"remove\/microk8s\/microk8s_node.html"},{"title":"microk8s","text":"Table of Contents Setup MicroK8s Reference Setup ARM64 Init #( 02\/17\/24@10:43PM )( donbuddenbaum@donbs-imac ):~\/Documents\/Kalaxy2\/cloud-init-setup@main\u2714 Node pi@arm64-05:~$ sudo passwd dbuddenbaum #( 02\/18\/24@ 1:00AM )( donbuddenbaum@donbs-imac ):~\/Documents\/Kalaxy2\/cloud-init-setup@main\u2717\u2717\u2717 dbuddenbaum@donb-ms7821:~$ ssh-keygen -f \u201c\/home\/dbuddenbaum\/.ssh\/known_hosts\u201d -R \u201c192.168.2.51\u201d dbuddenbaum@arm64-05:~$ sudo snap install microk8s \u2013classic \u2013channel=1.29\/stable buddenbaum@arm64-01:~$ sudo microk8s add-node dbuddenbaum@arm64-05:~$ sudo usermod -a -G microk8s dbuddenbaum dbuddenbaum@arm64-05:~$ sudo chown -f -R dbuddenbaum ~\/.kubesudo chown -f -R dbuddenbaum ~\/.kube #### dbuddenbaum@arm64-05:~$ newgrp microk8s dbuddenbaum@arm64-05:~$ microk8s join 192.168.2.51:25000\/64fd2ec74c48cdd2d113805beead7a28\/307234781a84 \u2013worker dbuddenbaum@arm64-01:~$ microk8s config &gt; config Cluster dbuddenbaum@amd64-03:~$ microk8s enable dns dbuddenbaum@amd64-03:~$ microk8s enable dashboard dbuddenbaum@amd64-03:~$ microk8s enable ingress dbuddenbaum@amd64-03:~$ microk8s enable metallb dbuddenbaum@amd64-03:~$ microk8s enable observability Dashboard #( 02\/18\/24@ 3:04PM )( donbuddenbaum@donbs-imac ):~\/Documents\/Kalaxy2\/yaml\/microk8s\/k8s-dashboard@main\u2717\u2717\u2717 #( 02\/18\/24@ 3:04PM )( donbuddenbaum@donbs-imac ):~\/Documents\/Kalaxy2\/yaml\/microk8s\/k8s-dashboard@main\u2717\u2717\u2717 #( 02\/18\/24@ 3:13PM )( donbuddenbaum@donbs-imac ):~\/Documents\/Kalaxy2\/yaml\/microk8s\/k8s-dashboard@main\u2717\u2717\u2717 #( 02\/18\/24@ 3:13PM )( donbuddenbaum@donbs-imac ):~\/Documents\/Kalaxy2\/yaml\/microk8s\/k8s-dashboard@main\u2717\u2717\u2717 Observability dbuddenbaum@arm64-01:~$ microk8s enable prometheus Grafana #( 02\/20\/24@ 6:54PM )( donbuddenbaum@donbs-imac ):~\/Documents\/Kalaxy2@main\u2717\u2717\u2717 #( 02\/20\/24@ 6:56PM )( donbuddenbaum@donbs-imac ):~\/Documents\/Kalaxy2@main\u2717\u2717\u2717 #( 02\/20\/24@ 7:47PM )( donbuddenbaum@donbs-imac ):~\/Documents\/Kalaxy2\/yaml\/microk8s\/prometheus@main\u2717\u2717\u2717 Config for Kubectl dbuddenbaum@arm64-01:~\/.kube$ #( 02\/29\/24@ 7:05PM )( donbuddenbaum@donbs-imac ):~\/.kube #( 02\/29\/24@ 7:05PM )( donbuddenbaum@donbs-imac ):~\/.kube #Setup MicroK8s #Reference How to create a ServiceMonitor in Microk8s: Observability Tutorial #Setup #ARM64 Init ##( 02\/17\/24@10:43PM )( donbuddenbaum@donbs-imac ):~\/Documents\/Kalaxy2\/cloud-init-setup@main\u2714 flash \u2013userdata cloud-config-4.yml ~\/Downloads\/RPI-USB-BOOT.img Is \/dev\/disk2 correct? y Unmounting \/dev\/disk2 ... Unmount of all volumes on disk2 was successful Unmount of all volumes on disk2 was successful Flashing \/Users\/donbuddenbaum\/Downloads\/RPI-USB-BOOT.img to \/dev\/rdisk2 ... Password: 3.03GiB 0:01:30 [34.3MiB\/s] [=======================================================================================================================================================================================================================================================================================================================&gt;] 100% 0+49604 records in 3100+1 records out 3250806272 bytes transferred in 77.088032 secs (42170051 bytes\/sec) Mounting Disk Mounting \/dev\/disk2 to customize... Copying cloud-init cloud-config-4.yml to \/Volumes\/system-boot\/user-data ... Unmounting \/dev\/disk2 ... &quot;disk2&quot; ejected. Finished. #Node #pi@arm64-05:~$ sudo passwd dbuddenbaum New password: Retype new password: passwd: password updated successfully ##( 02\/18\/24@ 1:00AM )( donbuddenbaum@donbs-imac ):~\/Documents\/Kalaxy2\/cloud-init-setup@main\u2717\u2717\u2717 ssh-copy-id dbuddenbaum@192.168.2.54 \/usr\/bin\/ssh-copy-id: INFO: Source of key(s) to be installed: &quot;\/Users\/donbuddenbaum\/.ssh\/id_rsa.pub&quot; \/usr\/bin\/ssh-copy-id: INFO: attempting to log in with the new key(s), to filter out any that are already installed \/usr\/bin\/ssh-copy-id: INFO: 1 key(s) remain to be installed -- if you are prompted now it is to install the new keys dbuddenbaum@192.168.2.54's password: Number of key(s) added: 1 Now try logging into the machine, with: &quot;ssh 'dbuddenbaum@192.168.2.54'&quot; and check to make sure that only the key(s) you wanted were added.## #dbuddenbaum@donb-ms7821:~$ ssh-keygen -f \u201c\/home\/dbuddenbaum\/.ssh\/known_hosts\u201d -R \u201c192.168.2.51\u201d # Host 192.168.2.51 found: line 2 \/home\/dbuddenbaum\/.ssh\/known_hosts updated. Original contents retained as \/home\/dbuddenbaum\/.ssh\/known_hosts.old #dbuddenbaum@arm64-05:~$ sudo snap install microk8s \u2013classic \u2013channel=1.29\/stable microk8s (1.29\/stable) v1.29.0 from Canonical\u2713 installed #buddenbaum@arm64-01:~$ sudo microk8s add-node From the node you wish to join to this cluster, run the following: microk8s join 192.168.2.51:25000\/64fd2ec74c48cdd2d113805beead7a28\/307234781a84 Use the '--worker' flag to join a node as a worker not running the control plane, eg: microk8s join 192.168.2.51:25000\/64fd2ec74c48cdd2d113805beead7a28\/307234781a84 --worker If the node you are adding is not reachable through the default interface you can use one of the following: microk8s join 192.168.2.51:25000\/64fd2ec74c48cdd2d113805beead7a28\/307234781a84 microk8s join 2603:6081:1e00:1075:dea6:32ff:febb:c8bf:25000\/64fd2ec74c48cdd2d113805beead7a28\/307234781a84 #dbuddenbaum@arm64-05:~$ sudo usermod -a -G microk8s dbuddenbaum #dbuddenbaum@arm64-05:~$ sudo chown -f -R dbuddenbaum ~\/.kubesudo chown -f -R dbuddenbaum ~\/.kube ##### dbuddenbaum@arm64-05:~$ newgrp microk8s #dbuddenbaum@arm64-05:~$ microk8s join 192.168.2.51:25000\/64fd2ec74c48cdd2d113805beead7a28\/307234781a84 \u2013worker Contacting cluster at 192.168.2.51 The node has joined the cluster and will appear in the nodes list in a few seconds. This worker node gets automatically configured with the API server endpoints. If the API servers are behind a loadbalancer please set the '--refresh-interval' to '0s' in: \/var\/snap\/microk8s\/current\/args\/apiserver-proxy and replace the API server endpoints with the one provided by the loadbalancer in: \/var\/snap\/microk8s\/current\/args\/traefik\/provider.yaml Successfully joined the cluster. #dbuddenbaum@arm64-01:~$ microk8s config &gt; config cd .kube rsync dbuddenbaum@amd64-03:~\/.kube\/config config #Cluster #dbuddenbaum@amd64-03:~$ microk8s enable dns Infer repository core for addon dns Addon core\/dns is already enabled #dbuddenbaum@amd64-03:~$ microk8s enable dashboard Infer repository core for addon dashboard Enabling Kubernetes Dashboard Infer repository core for addon metrics-server Enabling Metrics-Server serviceaccount\/metrics-server created clusterrole.rbac.authorization.k8s.io\/system:aggregated-metrics-reader created clusterrole.rbac.authorization.k8s.io\/system:metrics-server created rolebinding.rbac.authorization.k8s.io\/metrics-server-auth-reader created clusterrolebinding.rbac.authorization.k8s.io\/metrics-server:system:auth-delegator created clusterrolebinding.rbac.authorization.k8s.io\/system:metrics-server created service\/metrics-server created deployment.apps\/metrics-server created apiservice.apiregistration.k8s.io\/v1beta1.metrics.k8s.io created clusterrolebinding.rbac.authorization.k8s.io\/microk8s-admin created Adding argument --authentication-token-webhook to nodes. Metrics-Server is enabled Applying manifest serviceaccount\/kubernetes-dashboard created service\/kubernetes-dashboard created secret\/kubernetes-dashboard-certs created secret\/kubernetes-dashboard-csrf created secret\/kubernetes-dashboard-key-holder created configmap\/kubernetes-dashboard-settings created role.rbac.authorization.k8s.io\/kubernetes-dashboard created clusterrole.rbac.authorization.k8s.io\/kubernetes-dashboard created rolebinding.rbac.authorization.k8s.io\/kubernetes-dashboard created clusterrolebinding.rbac.authorization.k8s.io\/kubernetes-dashboard created deployment.apps\/kubernetes-dashboard created service\/dashboard-metrics-scraper created deployment.apps\/dashboard-metrics-scraper created secret\/microk8s-dashboard-token created If RBAC is not enabled access the dashboard using the token retrieved with: microk8s kubectl describe secret -n kube-system microk8s-dashboard-token Use this token in the https login UI of the kubernetes-dashboard service. In an RBAC enabled setup (microk8s enable RBAC) you need to create a user with restricted permissions as shown in: https:\/\/github.com\/kubernetes\/dashboard\/blob\/master\/docs\/user\/access-control\/creating-sample-user.md #dbuddenbaum@amd64-03:~$ microk8s enable ingress Infer repository core for addon ingress Enabling Ingress ingressclass.networking.k8s.io\/public created ingressclass.networking.k8s.io\/nginx created namespace\/ingress created serviceaccount\/nginx-ingress-microk8s-serviceaccount created clusterrole.rbac.authorization.k8s.io\/nginx-ingress-microk8s-clusterrole created role.rbac.authorization.k8s.io\/nginx-ingress-microk8s-role created clusterrolebinding.rbac.authorization.k8s.io\/nginx-ingress-microk8s created rolebinding.rbac.authorization.k8s.io\/nginx-ingress-microk8s created configmap\/nginx-load-balancer-microk8s-conf created configmap\/nginx-ingress-tcp-microk8s-conf created configmap\/nginx-ingress-udp-microk8s-conf created daemonset.apps\/nginx-ingress-microk8s-controller created Ingress is enabled #dbuddenbaum@amd64-03:~$ microk8s enable metallb Enabling MetalLB Enter each IP address range delimited by comma (e.g. '10.64.140.43-10.64.140.49,192.168.0.105-192.168.0.111'): 192.168.2.20-192.168.2.49 Applying Metallb manifest customresourcedefinition.apiextensions.k8s.io\/addresspools.metallb.io created customresourcedefinition.apiextensions.k8s.io\/bfdprofiles.metallb.io created customresourcedefinition.apiextensions.k8s.io\/bgpadvertisements.metallb.io created customresourcedefinition.apiextensions.k8s.io\/bgppeers.metallb.io created customresourcedefinition.apiextensions.k8s.io\/communities.metallb.io created customresourcedefinition.apiextensions.k8s.io\/ipaddresspools.metallb.io created customresourcedefinition.apiextensions.k8s.io\/l2advertisements.metallb.io created namespace\/metallb-system created serviceaccount\/controller created serviceaccount\/speaker created clusterrole.rbac.authorization.k8s.io\/metallb-system:controller created clusterrole.rbac.authorization.k8s.io\/metallb-system:speaker created role.rbac.authorization.k8s.io\/controller created role.rbac.authorization.k8s.io\/pod-lister created clusterrolebinding.rbac.authorization.k8s.io\/metallb-system:controller created clusterrolebinding.rbac.authorization.k8s.io\/metallb-system:speaker created rolebinding.rbac.authorization.k8s.io\/controller created secret\/webhook-server-cert created service\/webhook-service created rolebinding.rbac.authorization.k8s.io\/pod-lister created daemonset.apps\/speaker created deployment.apps\/controller created validatingwebhookconfiguration.admissionregistration.k8s.io\/validating-webhook-configuration created Waiting for Metallb controller to be ready. error: timed out waiting for the condition on deployments\/controller MetalLB controller is still not ready deployment.apps\/controller condition met ipaddresspool.metallb.io\/default-addresspool created l2advertisement.metallb.io\/default-advertise-all-pools created MetalLB is enabled dbuddenbaum@amd64-03:~$ microk8s enable helm3 Infer repository core for addon helm3 Addon core\/helm3 is already enabled #dbuddenbaum@amd64-03:~$ microk8s enable observability Infer repository core for addon observability Addon core\/dns is already enabled Addon core\/helm3 is already enabled Enabling default storage class. WARNING: Hostpath storage is not suitable for production environments. A hostpath volume can grow beyond the size limit set in the volume claim manifest. deployment.apps\/hostpath-provisioner created storageclass.storage.k8s.io\/microk8s-hostpath created serviceaccount\/microk8s-hostpath created clusterrole.rbac.authorization.k8s.io\/microk8s-hostpath created clusterrolebinding.rbac.authorization.k8s.io\/microk8s-hostpath created Storage will be available soon. Enabling observability Release &quot;kube-prom-stack&quot; does not exist. Installing it now. NAME: kube-prom-stack LAST DEPLOYED: Fri Mar 8 19:55:55 2024 NAMESPACE: observability STATUS: deployed REVISION: 1 NOTES: kube-prometheus-stack has been installed. Check its status by running: kubectl --namespace observability get pods -l &quot;release=kube-prom-stack&quot; Visit https:\/\/github.com\/prometheus-operator\/kube-prometheus for instructions on how to create &amp; configure Alertmanager and Prometheus instances using the Operator. Release &quot;loki&quot; does not exist. Installing it now. NAME: loki LAST DEPLOYED: Fri Mar 8 19:56:53 2024 NAMESPACE: observability STATUS: deployed REVISION: 1 NOTES: The Loki stack has been deployed to your cluster. Loki can now be added as a datasource in Grafana. See http:\/\/docs.grafana.org\/features\/datasources\/loki\/ for more detail. Release &quot;tempo&quot; does not exist. Installing it now. NAME: tempo LAST DEPLOYED: Fri Mar 8 19:56:56 2024 NAMESPACE: observability STATUS: deployed REVISION: 1 TEST SUITE: None Adding argument --authentication-kubeconfig to nodes. Adding argument --authorization-kubeconfig to nodes. Restarting nodes. Adding argument --authentication-kubeconfig to nodes. Adding argument --authorization-kubeconfig to nodes. Restarting nodes. The connection to the server 127.0.0.1:16443 was refused - did you specify the right host or port? Failed to list nodes (try 1): Command '['\/snap\/microk8s\/6641\/microk8s-kubectl.wrapper', 'get', 'node', '-o', 'json']' returned non-zero exit status 1. Adding argument --metrics-bind-address to nodes. Restarting nodes. The connection to the server 127.0.0.1:16443 was refused - did you specify the right host or port? Failed to list nodes (try 1): Command '['\/snap\/microk8s\/6641\/microk8s-kubectl.wrapper', 'get', 'node', '-o', 'json']' returned non-zero exit status 1. Note: the observability stack is setup to monitor only the current nodes of the MicroK8s cluster. For any nodes joining the cluster at a later stage this addon will need to be set up again. Observability has been enabled (user\/pass: admin\/prom-operator) #Dashboard ##( 02\/18\/24@ 3:04PM )( donbuddenbaum@donbs-imac ):~\/Documents\/Kalaxy2\/yaml\/microk8s\/k8s-dashboard@main\u2717\u2717\u2717 kubectl apply -f k8s-dashboard-adminuser.yaml serviceaccount\/admin-user created clusterrolebinding.rbac.authorization.k8s.io\/admin-user created ##( 02\/18\/24@ 3:04PM )( donbuddenbaum@donbs-imac ):~\/Documents\/Kalaxy2\/yaml\/microk8s\/k8s-dashboard@main\u2717\u2717\u2717 kubectl apply -f k8s-dashboard-lb-svc.yaml service\/k8s-dashboard created ##( 02\/18\/24@ 3:13PM )( donbuddenbaum@donbs-imac ):~\/Documents\/Kalaxy2\/yaml\/microk8s\/k8s-dashboard@main\u2717\u2717\u2717 kubectl -n kube-system create token admin-user eyJhbGciOiJSUzI1NiIsImtpZCI6ImNyRHBLN01nczgtX1liWVRsLW1VT21iaW5tQ2lYS2htTzZfS1BlUGVmZHMifQ.eyJhdWQiOlsiaHR0cHM6Ly9rdWJlcm5ldGVzLmRlZmF1bHQuc3ZjIl0sImV4cCI6MTcwODI5MDc5NiwiaWF0IjoxNzA4Mjg3MTk2LCJpc3MiOiJodHRwczovL2t1YmVybmV0ZXMuZGVmYXVsdC5zdmMiLCJrdWJlcm5ldGVzLmlvIjp7Im5hbWVzcGFjZSI6Imt1YmUtc3lzdGVtIiwic2VydmljZWFjY291bnQiOnsibmFtZSI6ImFkbWluLXVzZXIiLCJ1aWQiOiI2NDMxMDZiMi1mN2MyLTRlZGItYTk5YS0yN2ZjNjdjMTBlMGIifX0sIm5iZiI6MTcwODI4NzE5Niwic3ViIjoic3lzdGVtOnNlcnZpY2VhY2NvdW50Omt1YmUtc3lzdGVtOmFkbWluLXVzZXIifQ.AU-FVzF6U6OjC91tybe9AqdsMPZTlOu2qEuHSjEpXrjtYuy4SqLPtGrIMHqvySdNpgp0xyMNz0F-6L9ES4oNwZorTb5Rm3sSwuXNhkow_-gJw9Ao0LYKI9sg8Y3KaVbHY-WZmbxO36Ick5mJkh-V3YofvBoHcQtnC7MJHRjneOp-ht2VIL-Ob-y2CWfgwT3cGHdlU9lsBxz0FSQCvKzB3bszbp1jBoCNARS9YhVlMJq41dt5F0xX5XKbtV93RHpPScFGAltQXrPBj-Fy3ShtZ70JeJGg5NjwLqBSuplGaBuotSJxZVXJhNJgFkmjMR7kdrCaz8t6A1rCPnzAwLXcWA ##( 02\/18\/24@ 3:13PM )( donbuddenbaum@donbs-imac ):~\/Documents\/Kalaxy2\/yaml\/microk8s\/k8s-dashboard@main\u2717\u2717\u2717 kubectl get service -n kube-system NAME TYPE CLUSTER-IP EXTERNAL-IP PORT(S) AGE kube-dns ClusterIP 10.152.183.10 &lt;none&gt; 53\/UDP,53\/TCP,9153\/TCP 17h metrics-server ClusterIP 10.152.183.50 &lt;none&gt; 443\/TCP 14h kubernetes-dashboard ClusterIP 10.152.183.91 &lt;none&gt; 443\/TCP 14h dashboard-metrics-scraper ClusterIP 10.152.183.147 &lt;none&gt; 8000\/TCP 14h k8s-dashboard LoadBalancer 10.152.183.90 192.168.2.20 443:30545\/TCP 21m Kubernetes Dashboard Adjusting the timeout of the Kubernetes Dashboard kubectl patch --namespace kubernetes-dashboard deployment \\ kubernetes-dashboard --type='json' --patch \\ '[{&quot;op&quot;: &quot;add&quot;, &quot;path&quot;: &quot;\/spec\/template\/spec\/containers\/0\/args\/2&quot;, &quot;value&quot;: &quot;--token-ttl=43200&quot; }]' or #Observability #dbuddenbaum@arm64-01:~$ microk8s enable prometheus Infer repository core for addon prometheus DEPRECATION WARNING: 'prometheus' is deprecated and will soon be removed. Please use 'observability' instead. Infer repository core for addon observability Addon core\/dns is already enabled Addon core\/helm3 is already enabled Enabling default storage class. WARNING: Hostpath storage is not suitable for production environments. A hostpath volume can grow beyond the size limit set in the volume claim manifest. deployment.apps\/hostpath-provisioner created storageclass.storage.k8s.io\/microk8s-hostpath created serviceaccount\/microk8s-hostpath created clusterrole.rbac.authorization.k8s.io\/microk8s-hostpath created clusterrolebinding.rbac.authorization.k8s.io\/microk8s-hostpath created Storage will be available soon. Enabling observability Release &quot;kube-prom-stack&quot; does not exist. Installing it now. NAME: kube-prom-stack LAST DEPLOYED: Sun Feb 18 18:11:07 2024 NAMESPACE: observability STATUS: deployed REVISION: 1 NOTES: kube-prometheus-stack has been installed. Check its status by running: kubectl --namespace observability get pods -l &quot;release=kube-prom-stack&quot; Visit https:\/\/github.com\/prometheus-operator\/kube-prometheus for instructions on how to create &amp; configure Alertmanager and Prometheus instances using the Operator. Release &quot;loki&quot; does not exist. Installing it now. NAME: loki LAST DEPLOYED: Sun Feb 18 18:12:34 2024 NAMESPACE: observability STATUS: deployed REVISION: 1 NOTES: The Loki stack has been deployed to your cluster. Loki can now be added as a datasource in Grafana. See http:\/\/docs.grafana.org\/features\/datasources\/loki\/ for more detail. Release &quot;tempo&quot; does not exist. Installing it now. NAME: tempo LAST DEPLOYED: Sun Feb 18 18:12:40 2024 NAMESPACE: observability STATUS: deployed REVISION: 1 TEST SUITE: None Adding argument --authentication-kubeconfig to nodes. Adding argument --authorization-kubeconfig to nodes. Restarting nodes. The connection to the server 127.0.0.1:16443 was refused - did you specify the right host or port? Failed to list nodes (try 1): Command '['\/snap\/microk8s\/6357\/microk8s-kubectl.wrapper', 'get', 'node', '-o', 'json']' returned non-zero exit status 1. Adding argument --authentication-kubeconfig to nodes. Adding argument --authorization-kubeconfig to nodes. Restarting nodes. The connection to the server 127.0.0.1:16443 was refused - did you specify the right host or port? Failed to list nodes (try 1): Command '['\/snap\/microk8s\/6357\/microk8s-kubectl.wrapper', 'get', 'node', '-o', 'json']' returned non-zero exit status 1. Adding argument --metrics-bind-address to nodes. Restarting nodes. The connection to the server 127.0.0.1:16443 was refused - did you specify the right host or port? Failed to list nodes (try 1): Command '['\/snap\/microk8s\/6357\/microk8s-kubectl.wrapper', 'get', 'node', '-o', 'json']' returned non-zero exit status 1. Note: the observability stack is setup to monitor only the current nodes of the MicroK8s cluster. For any nodes joining the cluster at a later stage this addon will need to be set up again. Observability has been enabled (user\/pass: admin\/prom-operator) #Grafana ##( 02\/20\/24@ 6:54PM )( donbuddenbaum@donbs-imac ):~\/Documents\/Kalaxy2@main\u2717\u2717\u2717 kubectl get deployment -n observability NAME READY UP-TO-DATE AVAILABLE AGE kube-prom-stack-kube-prome-operator 1\/1 1 1 2d kube-prom-stack-kube-state-metrics 1\/1 1 1 2d kube-prom-stack-grafana 1\/1 1 1 2d ##( 02\/20\/24@ 6:56PM )( donbuddenbaum@donbs-imac ):~\/Documents\/Kalaxy2@main\u2717\u2717\u2717 kubectl port-forward deployment\/kube-prom-stack-grafana -n observability 3000 Forwarding from 127.0.0.1:3000 -&gt; 3000 Forwarding from [::1]:3000 -&gt; 3000 or for loadbalancer ##( 02\/20\/24@ 7:47PM )( donbuddenbaum@donbs-imac ):~\/Documents\/Kalaxy2\/yaml\/microk8s\/prometheus@main\u2717\u2717\u2717 kubectl apply -f grafana-lb-svc.yaml service\/grafana-dashboard configured #Config for Kubectl #dbuddenbaum@arm64-01:~\/.kube$ microk8s config &gt; config ##( 02\/29\/24@ 7:05PM )( donbuddenbaum@donbs-imac ):~\/.kube rsync dbuddenbaum@arm64-01:~\/.kube\/config config ##( 02\/29\/24@ 7:05PM )( donbuddenbaum@donbs-imac ):~\/.kube ls Untitled.pdf config.ha config.k8s.rpi4.old cache config.imac config.rpi4.opensource config config.k8s http-cache","tags":"","url":"setup\/microk8s.html"},{"title":"minio","text":"Table of Contents Minio References Setup dbuddenbaum@arm64-01:~$ Setup Node Storage dbuddenbaum@arm64-01:~$ dbuddenbaum@arm64-01:~$ dbuddenbaum@amd64-03:~$ dbuddenbaum@arm64-01:~$ dbuddenbaum@arm64-01:~$ sudo mkdir \/mnt\/hdisk dbuddenbaum@arm64-01:~$ sudo mount \/dev\/sdb \/mnt\/hdisk dbuddenbaum@arm64-01:~$ dbuddenbaum@arm64-01:~$ dbuddenbaum@arm64-02:~$ dbuddenbaum@amd64-03:~$ #Minio #References Easy Guide: Setting Up Minio with MicroK8s Kubernetes https:\/\/github.com\/minio\/operator #Setup #dbuddenbaum@arm64-01:~$ sudo microk8s enable minio -c 300Gi -s openebs-jiva-csi-default Infer repository core for addon minio Infer repository core for addon dns Addon core\/dns is already enabled Infer repository core for addon hostpath-storage Addon core\/hostpath-storage is already enabled Download kubectl-minio % Total % Received % Xferd Average Speed Time Time Time Current Dload Upload Total Spent Left Speed 0 0 0 0 0 0 0 0 --:--:-- --:--:-- --:--:-- 0 100 35.6M 100 35.6M 0 0 9495k 0 0:00:03 0:00:03 --:--:-- 10.9M Initialize minio operator namespace\/minio-operator created serviceaccount\/minio-operator created clusterrole.rbac.authorization.k8s.io\/minio-operator-role created clusterrolebinding.rbac.authorization.k8s.io\/minio-operator-binding created customresourcedefinition.apiextensions.k8s.io\/tenants.minio.min.io created service\/operator created deployment.apps\/minio-operator created serviceaccount\/console-sa created secret\/console-sa-secret created clusterrole.rbac.authorization.k8s.io\/console-sa-role created clusterrolebinding.rbac.authorization.k8s.io\/console-sa-binding created configmap\/console-env created service\/console created deployment.apps\/console created ----------------- To open Operator UI, start a port forward using this command: kubectl minio proxy -n minio-operator ----------------- Create default tenant with: Name: microk8s Capacity: 300Gi Servers: 1 Volumes: 1 Storage class: openebs-jiva-csi-default TLS: no Prometheus: no + \/var\/snap\/microk8s\/common\/plugins\/kubectl-minio tenant create microk8s --storage-class openebs-jiva-csi-default --capacity 300Gi --servers 1 --volumes 1 --namespace minio-operator --enable-audit-logs=false --disable-tls --enable-prometheus=false W0229 21:14:49.752537 71434 warnings.go:70] unknown field &quot;spec.pools[0].volumeClaimTemplate.metadata.creationTimestamp&quot; Tenant 'microk8s' created in 'minio-operator' Namespace Username: ICNSF7L1666PNW0K0TBO Password: pc9pNbTlBsotppIH6hjuB9KUMRxQaeeItkI1bZif Note: Copy the credentials to a secure location. MinIO will not display these again. APPLICATION SERVICE NAME NAMESPACE SERVICE TYPE SERVICE PORT MinIO minio minio-operator ClusterIP 80 Console microk8s-console minio-operator ClusterIP 9090 + set +x ================================ Enabled minio addon. You can manage minio tenants using the kubectl-minio plugin. For more details, use microk8s kubectl-minio --help #Setup Node Storage #dbuddenbaum@arm64-01:~$ lsblk -f NAME FSTYPE LABEL UUID FSAVAIL FSUSE% MOUNTPOINT loop0 squashfs 0 100% \/snap\/core18\/1883 loop1 squashfs 0 100% \/snap\/core20\/2107 loop2 squashfs 0 100% \/snap\/lxd\/24065 loop3 squashfs 0 100% \/snap\/core18\/2810 loop4 squashfs 0 100% \/snap\/core20\/2186 loop5 squashfs 0 100% \/snap\/lxd\/16103 loop6 squashfs 0 100% \/snap\/microk8s\/6357 loop7 squashfs 0 100% \/snap\/snapd\/20674 loop8 squashfs 0 100% \/snap\/microk8s\/6564 sda \u251c\u2500sda1 vfat system-boot B726-57E2 81.7M 68% \/boot\/firmware \u2514\u2500sda2 ext4 writable 483efb12-d682-4daf-9b34-6e2f774b56f7 201G 5% \/ sdb \u2514\u2500sdb1 vfat UNTITLED B1E2-1721 #dbuddenbaum@arm64-01:~$ fdisk dev\/sdb Welcome to fdisk (util-linux 2.34). Changes will remain in memory only, until you decide to write them. Be careful before using the write command. Command (m for help): d Selected partition 1 Partition 1 has been deleted. Command (m for help): w The partition table has been altered. Calling ioctl() to re-read partition table. Syncing disks. #dbuddenbaum@amd64-03:~$ sudo mkfs.ext4 \/dev\/sdb mke2fs 1.45.5 (07-Jan-2020) Found a dos partition table in \/dev\/sdb Proceed anyway? (y,N) y Creating filesystem with 244190646 4k blocks and 61054976 inodes Filesystem UUID: 95ec5a28-daf8-475a-b6f0-06b20d1f154f Superblock backups stored on blocks: 32768, 98304, 163840, 229376, 294912, 819200, 884736, 1605632, 2654208, 4096000, 7962624, 11239424, 20480000, 23887872, 71663616, 78675968, 102400000, 214990848 Allocating group tables: done Writing inode tables: done Creating journal (262144 blocks): done Writing superblocks and filesystem accounting information: done #dbuddenbaum@arm64-01:~$ lsblk -f NAME FSTYPE LABEL UUID FSAVAIL FSUSE% MOUNTPOINT loop0 squashfs 0 100% \/snap\/core18\/1883 loop1 squashfs 0 100% \/snap\/core20\/2107 loop2 squashfs 0 100% \/snap\/lxd\/24065 loop3 squashfs 0 100% \/snap\/core18\/2810 loop4 squashfs 0 100% \/snap\/core20\/2186 loop5 squashfs 0 100% \/snap\/lxd\/16103 loop6 squashfs 0 100% \/snap\/microk8s\/6357 loop7 squashfs 0 100% \/snap\/snapd\/20674 loop8 squashfs 0 100% \/snap\/microk8s\/6564 sda \u251c\u2500sda1 vfat system-boot B726-57E2 81.7M 68% \/boot\/firmware \u2514\u2500sda2 ext4 writable 483efb12-d682-4daf-9b34-6e2f774b56f7 201G 5% \/ sdb ext4 95ec5a28-daf8-475a-b6f0-06b20d1f154f #dbuddenbaum@arm64-01:~$ sudo mkdir \/mnt\/hdisk #dbuddenbaum@arm64-01:~$ sudo mount \/dev\/sdb \/mnt\/hdisk #dbuddenbaum@arm64-01:~$ lsblk -f NAME FSTYPE LABEL UUID FSAVAIL FSUSE% MOUNTPOINT loop0 squashfs 0 100% \/snap\/core18\/1883 loop1 squashfs 0 100% \/snap\/core20\/2107 loop2 squashfs 0 100% \/snap\/lxd\/24065 loop3 squashfs 0 100% \/snap\/core18\/2810 loop4 squashfs 0 100% \/snap\/core20\/2186 loop5 squashfs 0 100% \/snap\/lxd\/16103 loop6 squashfs 0 100% \/snap\/microk8s\/6357 loop7 squashfs 0 100% \/snap\/snapd\/20674 loop8 squashfs 0 100% \/snap\/microk8s\/6564 sda \u251c\u2500sda1 vfat system-boot B726-57E2 81.7M 68% \/boot\/firmware \u2514\u2500sda2 ext4 writable 483efb12-d682-4daf-9b34-6e2f774b56f7 200.9G 5% \/ sdb ext4 95ec5a28-daf8-475a-b6f0-06b20d1f154f 869.2G 0% \/mnt\/hdisk #dbuddenbaum@arm64-01:~$ sudo vi \/etc\/fstab UUID=95ec5a28-daf8-475a-b6f0-06b20d1f154f \/mnt\/hdisk ext4 defaults 0 0 #dbuddenbaum@arm64-02:~$ microk8s stop 2024-02-29T20:22:57-05:00 INFO Waiting for &quot;snap.microk8s.daemon-k8s-dqlite.service&quot; to stop. Stopped. #dbuddenbaum@amd64-03:~$ sudo reboot","tags":"","url":"setup\/minio.html"},{"title":"notes","text":"Table of Contents Installation Notes Raspberry Pi Monitoring make up Flash AMD64 static ip ssh swapfile update\/upgrade Add User Change password SUDO Copy Id getting events from kubernetes Persistent Volume update secutiry fixes temperature probe amd64 Updating Linux #Installation Notes Build Bare Metal Kubernetes Dualstack Calico Metallb RaspberryPI 4 Ubuntu Server 64bit. (64bit required!!!) Force all pods in a specific namespace to schedule on defined hosts with Kubernetes Control Pod Placement to Projects Understanding and using the Kubernetes PodNodeSelector Admission Controller k8s HA cluster installation Fabian Lee : Software Engineer Install Ubuntu Desktop 20.04 LTS on Raspberry Pi 4 Installing fully-fledged vanilla Kubernetes on Raspberry Pi #Raspberry Pi Monitoring sudo apt-get update &amp;&amp; sudo apt-get install htop -y #make up xcode-select --install #Flash flash --userdata setup\/cloud-config.yml ~\/Downloads\/ubuntu-20.04-preinstalled-server-arm64+raspi.img #AMD64 #static ip (AMD) sudo vim \/etc\/netplan\/01-netcfg.yaml (ARM) \/etc\/netplan\/50-cloud-init.yaml network: version: 2 ethernets: eth0: dhcp4: false addresses: [192.168.2.5?\/16] gateway4: 192.168.2.253 nameservers: addresses: [192.168.2.253, 8.8.8.8, 8.8.4.4] sudo netplan apply ip address #ssh sudo apt install ssh sudo systemctl enable \u2013now ssh sudo systemctl status ssh #swapfile sudo vim \/etc\/fstab #\/swapfile sudo reboot or sudo poweroff #update\/upgrade su #Add User How To Use visudo Sudo nopasswd: How to run commands as root without a password? sudo adduser -u 1200 &lt;username&gt; #Change password pi@arm64-05:~$ sudo passwd dbuddenbaum New password: Retype new password: passwd: password updated successfully #SUDO sudo visudo dbuddenbaum ALL=(ALL) NOPASSWD:ALL &lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD #Copy Id ssh-copy-id pi@$ip_address ======= ssh-copy-id dbuddenbaum@192.168.2.58 \/usr\/bin\/ssh-copy-id: INFO: Source of key(s) to be installed: &quot;\/Users\/donbuddenbaum\/.ssh\/id_rsa.pub&quot; \/usr\/bin\/ssh-copy-id: INFO: attempting to log in with the new key(s), to filter out any that are already installed \/usr\/bin\/ssh-copy-id: INFO: 1 key(s) remain to be installed -- if you are prompted now it is to install the new keys dbuddenbaum@192.168.2.58's password: Number of key(s) added: 1 Now try logging into the machine, with: &quot;ssh 'dbuddenbaum@192.168.2.58'&quot; and check to make sure that only the key(s) you wanted were added. 38d6a03510f3dafb5c27383383689baf396cd5ce dbuddenbaum@amd64-worker-03:~$ sudo vim \/etc\/sysctl.d\/99-kubernetes-cri.conf net.bridge.bridge-nf-call-iptables=1 \/usr\/sbin\/sysctl net.bridge.bridge-nf-call-iptables=1 \/usr\/sbin\/sysctl\/net.bridge.bridge-nf-call-iptables=1 net.bridge.bridge-nf-call-ip6tables=1 net.bridge.bridge-nf-call-arptables=1 sudo modprobe br_netfilter nstall Ceph on ARM64 SBCs using Rook - kubernetes-xenial main v1.9.3 dbuddenbaum@amd64-worker-03:~$ echo \u201cdeb http:\/\/packages.azlux.fr\/debian\/ buster main\u201d | sudo tee \/etc\/apt\/sources.list.d\/azlux.list deb http:\/\/packages.azlux.fr\/debian\/ buster main dbuddenbaum@amd64-worker-03:~$ wget -qO - https:\/\/azlux.fr\/repo.gpg.key | sudo apt-key add - OK dbuddenbaum@amd64-worker-03:~$ sudo apt update Hit:1 http:\/\/us.archive.ubuntu.com\/ubuntu focal InRelease Building dependency tree Reading state information... Done All packages are up to date. N: Skipping acquire of configured file 'stable\/binary-i386\/Packages' as repository 'https:\/\/download.docker.com\/linux\/ubuntu focal InRelease' doesn't support architecture 'i386' dbuddenbaum@amd64-worker-03:~$ sudo apt install log2ram Reading package lists... Done Building dependency tree Reading state information... Done The following packages were automatically installed and are no longer required: conntrack cri-tools ebtables socat Use 'sudo apt autoremove' to remove them. The following NEW packages will be installed: log2ram 0 upgraded, 1 newly installed, 0 to remove and 0 not upgraded. Need to get 4288 B of archives. After this operation, 0 B of additional disk space will be used. Get:1 http:\/\/packages.azlux.fr\/debian buster\/main amd64 log2ram all 1.6.0 [4288 B] Fetched 4288 B in 1s (7037 B\/s) Selecting previously unselected package log2ram. (Reading database ... 107469 files and directories currently installed.) Preparing to unpack ...\/archives\/log2ram_1.6.0_all.deb ... Unpacking log2ram (1.6.0) ... Setting up log2ram (1.6.0) ... Created symlink \/etc\/systemd\/system\/sysinit.target.wants\/log2ram.service \u2192 \/etc\/systemd\/system\/log2ram.service. Created symlink \/etc\/systemd\/system\/timers.target.wants\/log2ram-daily.timer \u2192 \/etc\/systemd\/system\/log2ram-daily.timer. ##### Reboot to activate log2ram ##### ##### edit \/etc\/log2ram.conf to configure options #### make OPTS=\u2013limit=amd64-worker-xx up fix token kubeadm token create -&gt; build\/k8s-token dbuddenbaum@arm64-master-01:~$ sudo kubeadm token create \u2013print-join-command W1017 21:24:48.048542 1003621 validation.go:28] Cannot validate kube-proxy config - no validator is available W1017 21:24:48.048690 1003621 validation.go:28] Cannot validate kubelet config - no validator is available kubeadm join 192.168.2.50:6443 --token 1lzi9g.q1e5iabf9ct3khwe --discovery-token-ca-cert-hash sha256:758ae780462b33c21506c4052e4e1de8ddec35ffc167a931fa1cd6f85ff9ede3 dbuddenbaum@amd64-worker-02:~$ sudo kubeadm join 192.168.2.50:6443 \u2013token 1lzi9g.q1e5iabf9ct3khwe \u2013discovery-token-ca-cert-hash sha256:758ae780462b33c21506c4052e4e1de8ddec35ffc167a931fa1cd6f85ff9ede3 W1018 01:26:30.473800 6631 join.go:346] [preflight] WARNING: JoinControlPane.controlPlane settings will be ignored when control-plane flag is not set. [preflight] Running pre-flight checks [WARNING IsDockerSystemdCheck]: detected &quot;cgroupfs&quot; as the Docker cgroup driver. The recommended driver is &quot;systemd&quot;. Please follow the guide at https:\/\/kubernetes.io\/docs\/setup\/cri\/ [preflight] Reading configuration from the cluster... [preflight] FYI: You can look at this config file with 'kubectl -n kube-system get cm kubeadm-config -oyaml' [kubelet-start] Downloading configuration for the kubelet from the &quot;kubelet-config-1.17&quot; ConfigMap in the kube-system namespace [kubelet-start] Writing kubelet configuration to file &quot;\/var\/lib\/kubelet\/config.yaml&quot; [kubelet-start] Writing kubelet environment file with flags to file &quot;\/var\/lib\/kubelet\/kubeadm-flags.env&quot; [kubelet-start] Starting the kubelet [kubelet-start] Waiting for the kubelet to perform the TLS Bootstrap... This node has joined the cluster: * Certificate signing request was sent to apiserver and a response was received. * The Kubelet was informed of the new secure connection details. Run 'kubectl get nodes' on the control-plane to see this node join the cluster. #getting events from kubernetes kubectl get events \u2013all-namespaces \u2013sort-by=\u2019.metadata.creationTimestamp\u2019 #Persistent Volume #update secutiry fixes apt-get update sudo apt-get install -y \u2013only-upgrade $( apt-get \u2013just-print upgrade | awk \u2018tolower($4) ~ \/.security.\/ || tolower($5) ~ \/.security.\/ {print $2}\u2019 | sort | uniq ) ###cgroups for intel One aspect I want to point out is setting the cgroup for use by kubeadm. If you choose to use Docker as your container runtime, you should set it to use the cgroup systemd rather than cgroupfs as explained here. In \/etc\/docker\/daemon.conf { &quot;exec-opts&quot;: [&quot;native.cgroupdriver=systemd&quot;], &quot;log-driver&quot;: &quot;json-file&quot;, &quot;log-opts&quot;: { &quot;max-size&quot;: &quot;100m&quot; }, &quot;storage-driver&quot;: &quot;overlay2&quot; } Then reload sudo systemctl daemon-reload sudo systemctl restart docker #temperature probe amd64 sudo apt-get install lm-sensors sudo service kmod start dbuddenbaum@amd64-05:~$ sensors coretemp-isa-0000 Adapter: ISA adapter Core 0: +70.0\u00b0C (high = +74.0\u00b0C, crit = +100.0\u00b0C) Core 1: +63.0\u00b0C (high = +74.0\u00b0C, crit = +100.0\u00b0C) Core 2: +65.0\u00b0C (high = +74.0\u00b0C, crit = +100.0\u00b0C) Core 3: +64.0\u00b0C (high = +74.0\u00b0C, crit = +100.0\u00b0C) sudo sensors-detect #Updating Linux sudo apt-get update sudo apt-get upgrade sudo reboot","tags":"","url":"setup\/notes.html"},{"title":"README","text":"Table of Contents Ubuntu Downloads the Flash tool Download and extract the image Flash Boot USB Boot #Ubuntu The following instructions are to flash your SD card with the desired OS and configuration specified in the cloud-init config. See https:\/\/cloudinit.readthedocs.io\/en\/latest\/ for more details. cloud-init cloud-init-doc #Downloads the Flash tool sudo curl -L \"https:\/\/github.com\/hypriot\/flash\/releases\/download\/2.5.0\/flash\" -o \/usr\/local\/bin\/flash sudo chmod +x \/usr\/local\/bin\/flash #Download and extract the image curl -L \"http:\/\/cdimage.ubuntu.com\/releases\/focal\/release\/ubuntu-20.04-preinstalled-server-arm64+raspi.img.xz\" -o ~\/Downloads\/ubuntu-20.04-preinstalled-server-arm64+raspi.img.xz unxz -T 0 ~\/Downloads\/ubuntu-20.04-preinstalled-server-arm64+raspi.img.xz #Flash flash --userdata setup\/cloud-config.yml ~\/Downloads\/ubuntu-20.04.2-preinstalled-server-arm64+raspi.img #Boot Place the SD Card in your RPi and give the system approx ~10 minutes to boot before trying to SSH. #USB Boot ####( 09\/06\/21@ 1:00AM )( donbuddenbaum@donbs-iMac ):~\/Documents\/rPi4\/kalaxy@main\u2717\u2717\u2717 flash \\ --userdata setup\/cloud-config-5.yml \\ ~\/Downloads\/ubuntu-20.04.2-preinstalled-server-arm64+raspi.img Is \/dev\/disk3 correct? flash --userdata setup\/cloud-config-4.yml ~\/Downloads\/RPI-USB-BOOT.img switch to USB drive to trick flash remove the card, reboot, and then add the card to solve the boot requirement. so the rPi looks for a new boot devices Is \/dev\/disk3 correct? y Unmounting \/dev\/disk3 ... Unmount of all volumes on disk3 was successful Unmount of all volumes on disk3 was successful Flashing \/Users\/donbuddenbaum\/Downloads\/ubuntu-20.04.2-preinstalled-server-arm64+raspi.img to \/dev\/rdisk3 ... Password:","tags":"","url":"setup\/README.html"},{"title":"rpi usb ubuntu","text":"Table of Contents USB RPI 4 Boot for Ubuntu #USB RPI 4 Boot for Ubuntu RPI4 Direct USB Boot Ubuntu 20.04 #( 09\/13\/21@11:43PM )( donbuddenbaum@donbs-iMac ):~\/Documents\/rPi4\/kalaxy@main\u2717\u2717\u2717 flash \u2013userdata setup\/cloud-config-4.yml ~\/Downloads\/RPI-USB-BOOT.img Is \/dev\/disk2 correct? y Unmounting \/dev\/disk2 ... Unmount of all volumes on disk2 was successful Unmount of all volumes on disk2 was successful Flashing \/Users\/donbuddenbaum\/Downloads\/RPI-USB-BOOT.img to \/dev\/rdisk2 ... 3.03GiB 0:01:21 [38.1MiB\/s] [====================================================================================================================================================================================================================================================================================================&gt;] 100% 0+49604 records in 0+49604 records out 3250806272 bytes transferred in 81.256937 secs (40006508 bytes\/sec) Mounting Disk Mounting \/dev\/disk2 to customize... Copying cloud-init setup\/cloud-config-4.yml to \/Volumes\/system-boot\/user-data ... Unmounting \/dev\/disk2 ... &quot;disk2&quot; ejected. Finished.","tags":"","url":"setup\/rpi_usb_ubuntu.html"},{"title":"k9s","text":"Table of Contents K9s References Setup Brew #( 02\/05\/22@11:04PM )( dbuddenbaum@donb-mbp4 ):~ Docker #( 11\/22\/22@ 3:43PM )( donbuddenbaum@donbs-imac ):~ #K9s #References K9s - Kubernetes CLI To Manage Your Clusters In Style! Use Docker to Run K9s to Manage a Kubernetes Cluster #Setup #Brew ##( 02\/05\/22@11:04PM )( dbuddenbaum@donb-mbp4 ):~ brew install derailed\/k9s\/k9s Running `brew update --preinstall`... ==&gt; Homebrew is run entirely by unpaid volunteers. Please consider donating: https:\/\/github.com\/Homebrew\/brew#donations ==&gt; Auto-updated Homebrew! Updated 1 tap (homebrew\/core). ==&gt; New Formulae ascii2binary ffmpeg@4 reshape asyncapi ghcup rure atlas http-prompt terminalimageviewer canfigger inotify-tools tfschema elixir-ls juliaup tidy-viewer elvis libadwaita usbutils esphome linode-cli vermin fdroidcl odo-dev weggli ==&gt; Updated Formulae Updated 799 formulae. ==&gt; Tapping derailed\/k9s Cloning into '\/usr\/local\/Homebrew\/Library\/Taps\/derailed\/homebrew-k9s'... remote: Enumerating objects: 788, done. remote: Counting objects: 100% (372\/372), done. remote: Compressing objects: 100% (186\/186), done. remote: Total 788 (delta 90), reused 0 (delta 0), pack-reused 416 Receiving objects: 100% (788\/788), 86.15 KiB | 4.53 MiB\/s, done. Resolving deltas: 100% (192\/192), done. Tapped 1 formula (12 files, 113.2KB). ==&gt; Downloading https:\/\/github.com\/derailed\/k9s\/releases\/download\/v0.25.18\/k9s_D ==&gt; Downloading from https:\/\/objects.githubusercontent.com\/github-production-rel ######################################################################## 100.0% ==&gt; Installing k9s from derailed\/k9s \ud83c\udf7a \/usr\/local\/Cellar\/k9s\/0.25.18: 5 files, 59.3MB, built in 6 seconds ==&gt; Running `brew cleanup k9s`... Disable this behaviour by setting HOMEBREW_NO_INSTALL_CLEANUP. Hide these hints with HOMEBREW_NO_ENV_HINTS (see `man brew`). #Docker ##( 11\/22\/22@ 3:43PM )( donbuddenbaum@donbs-imac ):~ docker run \u2013rm -it -v ~\/.kube\/config:\/root\/.kube\/config quay.io\/derailed\/k9s","tags":"","url":"utilities\/k9s.html"}]});